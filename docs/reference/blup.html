<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Best Linear Unbiased Predictions for 'rma.uni' Objects — blup • metafor</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Best Linear Unbiased Predictions for 'rma.uni' Objects — blup" />

<meta property="og:description" content="The function calculates best linear unbiased predictions (BLUPs) of the study-specific true outcomes by combining the fitted values based on the fixed effects and the estimated contributions of the random effects for objects of class "rma.uni". Corresponding standard errors and prediction interval bounds are also provided." />
<meta name="twitter:card" content="summary" />


<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">metafor</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">2.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/metafor-package.html">Intro</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://twitter.com/wviechtb">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/wviechtb/metafor">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Best Linear Unbiased Predictions for 'rma.uni' Objects</h1>
    
    <div class="hidden name"><code>blup.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>The function calculates best linear unbiased predictions (BLUPs) of the study-specific true outcomes by combining the fitted values based on the fixed effects and the estimated contributions of the random effects for objects of class <code>"rma.uni"</code>. Corresponding standard errors and prediction interval bounds are also provided.</p>
    
    </div>

    <pre class="usage">blup(x, &#8230;)

# S3 method for rma.uni
blup(x, level, digits, transf, targs, &#8230;)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>an object of class <code>"rma.uni"</code>.</p></td>
    </tr>
    <tr>
      <th>level</th>
      <td><p>numerical value between 0 and 100 specifying the prediction interval level (if unspecified, the default is to take the value from the object).</p></td>
    </tr>
    <tr>
      <th>digits</th>
      <td><p>integer specifying the number of decimal places to which the printed results should be rounded (if unspecified, the default is to take the value from the object).</p></td>
    </tr>
    <tr>
      <th>transf</th>
      <td><p>optional argument specifying the name of a function that should be used to transform the predicted values and interval bounds (e.g., <code>transf=exp</code>; see also <a href='transf.html'>transf</a>). If unspecified, no transformation is used.</p></td>
    </tr>
    <tr>
      <th>targs</th>
      <td><p>optional arguments needed by the function specified under <code>transf</code>.</p></td>
    </tr>
    <tr>
      <th>&#8230;</th>
      <td><p>other arguments.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <code>"list.rma"</code>. The object is a list containing the following components:</p>
<dt>pred</dt><dd><p>predicted values.</p></dd>
   <dt>se</dt><dd><p>corresponding standard errors.</p></dd>
   <dt>pi.lb</dt><dd><p>lower bound of the prediction intervals.</p></dd>
   <dt>pi.ub</dt><dd><p>upper bound of the prediction intervals.</p></dd>
   <dt>&#8230;</dt><dd><p>some additional elements/values.</p></dd>

   The "list.rma" object is formatted and printed with <a href='print.list.rma.html'>print.list.rma</a>.

    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>For best linear unbiased predictions of only the random effects, see <code><a href='ranef.html'>ranef</a></code>.</p>
<p>For predicted/fitted values that are based only on the fixed effects of the model, see <code><a href='fitted.rma.html'>fitted.rma</a></code> and <code><a href='predict.rma.html'>predict.rma</a></code>.</p>
<p>For conditional residuals (the deviations of the observed outcomes from the BLUPs), see <code>rstandard.rma.uni</code> with <code>type="conditional"</code>.</p>
<p>Fixed-effects models (with or without moderators) do not contain random study effects. The BLUPs for these models will therefore be equal to the usual fitted values, that is, those obtained with <code><a href='fitted.rma.html'>fitted.rma</a></code> and <code><a href='predict.rma.html'>predict.rma</a></code>.</p>
<p>When using the <code>transf</code> argument, the transformation is applied to the predicted values and the corresponding interval bounds. The standard errors are then set equal to <code>NA</code> and are omitted from the printed output.</p>
<p>The normal distribution is used to calculate the prediction intervals. When the model was fitted with the Knapp and Hartung (2003) method (i.e., <code>test="knha"</code> in the <code><a href='rma.uni.html'>rma.uni</a></code> function), then the t-distribution with \(k-p\) degrees of freedom is used.</p>
<p>To be precise, it should be noted that the function actually calculates empirical BLUPs (eBLUPs), since the predicted values are a function of the estimated value of \(\tau^2\).</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Kackar, R. N., &amp; Harville, D. A. (1981). Unbiasedness of two-stage estimation and prediction procedures for mixed linear models. Communications in Statistics, Theory and Methods, <b>10</b>, 1249--1261.</p>
<p>Raudenbush, S. W., &amp; Bryk, A. S. (1985). Empirical Bayes meta-analysis. <em>Journal of Educational Statistics</em>, <b>10</b>, 75--98.</p>
<p>Robinson, G. K. (1991). That BLUP is a good thing: The estimation of random effects. <em>Statistical Science</em>, <b>6</b>, 15--32.</p>
<p>Viechtbauer, W. (2010). Conducting meta-analyses in R with the metafor package. <em>Journal of Statistical Software</em>, <b>36</b>(3), 1--48. <a href='http://www.jstatsoft.org/v36/i03/'>http://www.jstatsoft.org/v36/i03/</a>.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='rma.uni.html'>rma.uni</a></code>, <code><a href='predict.rma.html'>predict.rma</a></code>, <code><a href='fitted.rma.html'>fitted.rma</a></code>, <code><a href='ranef.html'>ranef.rma.uni</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>### calculate log risk ratios and corresponding sampling variances</span>
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='escalc.html'>escalc</a></span>(<span class='kw'>measure</span><span class='kw'>=</span><span class='st'>"RR"</span>, <span class='kw'>ai</span><span class='kw'>=</span><span class='no'>tpos</span>, <span class='kw'>bi</span><span class='kw'>=</span><span class='no'>tneg</span>, <span class='kw'>ci</span><span class='kw'>=</span><span class='no'>cpos</span>, <span class='kw'>di</span><span class='kw'>=</span><span class='no'>cneg</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>dat.bcg</span>)

<span class='co'>### meta-analysis of the log risk ratios using a random-effects model</span>
<span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='rma.uni.html'>rma</a></span>(<span class='no'>yi</span>, <span class='no'>vi</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>dat</span>)

<span class='co'>### BLUPs of the true risk ratios for each study</span>
<span class='fu'>blup</span>(<span class='no'>res</span>, <span class='kw'>transf</span><span class='kw'>=</span><span class='no'>exp</span>)</div><div class='output co'>#&gt; 
#&gt;      pred  pi.lb  pi.ub 
#&gt; 1  0.4492 0.2012 1.0032 
#&gt; 2  0.2860 0.1431 0.5716 
#&gt; 3  0.3727 0.1590 0.8740 
#&gt; 4  0.2471 0.1887 0.3236 
#&gt; 5  0.7502 0.4958 1.1352 
#&gt; 6  0.4563 0.3883 0.5362 
#&gt; 7  0.2882 0.1400 0.5936 
#&gt; 8  1.0029 0.8871 1.1338 
#&gt; 9  0.6024 0.3911 0.9279 
#&gt; 10 0.2873 0.1775 0.4651 
#&gt; 11 0.7021 0.5665 0.8702 
#&gt; 12 0.7522 0.3064 1.8469 
#&gt; 13 0.8635 0.5359 1.3915 
#&gt; </div><div class='input'>
<span class='co'>### illustrate shrinkage of BLUPs towards the (estimated) population average</span>
<span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='rma.uni.html'>rma</a></span>(<span class='no'>yi</span>, <span class='no'>vi</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>dat</span>)
<span class='no'>blups</span> <span class='kw'>&lt;-</span> <span class='fu'>blup</span>(<span class='no'>res</span>)$<span class='no'>pred</span>
<span class='fu'>plot</span>(<span class='fl'>NA</span>, <span class='fl'>NA</span>, <span class='kw'>xlim</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>.8</span>,<span class='fl'>2.4</span>), <span class='kw'>ylim</span><span class='kw'>=</span><span class='fu'>c</span>(-<span class='fl'>2</span>,<span class='fl'>0.5</span>), <span class='kw'>pch</span><span class='kw'>=</span><span class='fl'>19</span>,
     <span class='kw'>xaxt</span><span class='kw'>=</span><span class='st'>"n"</span>, <span class='kw'>bty</span><span class='kw'>=</span><span class='st'>"n"</span>, <span class='kw'>xlab</span><span class='kw'>=</span><span class='st'>""</span>, <span class='kw'>ylab</span><span class='kw'>=</span><span class='st'>"Log Risk Ratio"</span>)</div><div class='input'><span class='fu'>segments</span>(<span class='fu'>rep</span>(<span class='fl'>1</span>,<span class='fl'>13</span>), <span class='no'>dat</span>$<span class='no'>yi</span>, <span class='fu'>rep</span>(<span class='fl'>2</span>,<span class='fl'>13</span>), <span class='no'>blups</span>, <span class='kw'>col</span><span class='kw'>=</span><span class='st'>"darkgray"</span>)</div><div class='input'><span class='fu'>points</span>(<span class='fu'>rep</span>(<span class='fl'>1</span>,<span class='fl'>13</span>), <span class='no'>dat</span>$<span class='no'>yi</span>, <span class='kw'>pch</span><span class='kw'>=</span><span class='fl'>19</span>)</div><div class='input'><span class='fu'>points</span>(<span class='fu'>rep</span>(<span class='fl'>2</span>,<span class='fl'>13</span>), <span class='no'>blups</span>, <span class='kw'>pch</span><span class='kw'>=</span><span class='fl'>19</span>)</div><div class='input'><span class='fu'>axis</span>(<span class='kw'>side</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>at</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>1</span>,<span class='fl'>2</span>), <span class='kw'>labels</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='st'>"Observed\nValues"</span>, <span class='st'>"BLUPs"</span>), <span class='kw'>lwd</span><span class='kw'>=</span><span class='fl'>0</span>)</div><div class='input'><span class='fu'>segments</span>(<span class='fl'>.7</span>, <span class='no'>res</span>$<span class='no'>beta</span>, <span class='fl'>2.15</span>, <span class='no'>res</span>$<span class='no'>beta</span>, <span class='kw'>lty</span><span class='kw'>=</span><span class='st'>"dotted"</span>)</div><div class='input'><span class='fu'>text</span>(<span class='fl'>2.3</span>, <span class='no'>res</span>$<span class='no'>beta</span>, <span class='fu'>expression</span>(<span class='fu'>hat</span>(<span class='no'>mu</span>)<span class='kw'>==</span>-<span class='fl'>0.71</span>), <span class='kw'>cex</span><span class='kw'>=</span><span class='fl'>1</span>)</div><div class='img'><img src='blup-1.png' alt='' width='768' height='614' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
   Wolfgang Viechtbauer <a href='mailto:wvb@metafor-project.org'>wvb@metafor-project.org</a> <a href='http://www.metafor-project.org/'>http://www.metafor-project.org/</a>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Wolfgang Viechtbauer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

