<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Selection Model — selmodel • metafor</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Selection Model — selmodel" />
<meta property="og:description" content="Function to fit selection models. " />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">metafor</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.5-54</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/metafor-package.html">Intro</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../articles/pkgdown/diagram.html">Diagram</a>
</li>
<li>
  <a href="https://www.jstatsoft.org/index.php/jss/article/view/v036i03/v36i03.pdf">JSS Article (pdf)</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://twitter.com/wviechtb">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/wviechtb/metafor">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Selection Model</h1>
    
    <div class="hidden name"><code>selmodel.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Function to fit selection models. <script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script></p>
    </div>

    <pre class="usage"><span class='fu'>selmodel</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for rma.uni</span>
<span class='fu'>selmodel</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>type</span>, alternative<span class='op'>=</span><span class='st'>"greater"</span>, <span class='va'>prec</span>,
         <span class='va'>delta</span>, <span class='va'>steps</span>, verbose<span class='op'>=</span><span class='cn'>FALSE</span>, <span class='va'>digits</span>, <span class='va'>control</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>an object of class <code>"rma.uni"</code>.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>character string to specify the type of selection model. Possible options are <code>"beta"</code>, <code>"halfnorm"</code>, <code>"negexp"</code>, <code>"logistic"</code>, <code>"power"</code>, <code>"negexppow"</code>, or <code>"stepfun"</code>. Can be abbreviated. See &#8216;Details&#8217;.</p></td>
    </tr>
    <tr>
      <th>alternative</th>
      <td><p>character string to specify the sidedness of the hypothesis when testing the observed effect sizes or outcomes. Possible options are <code>"greater"</code> (the default), <code>"less"</code>, or <code>"two.sided"</code>. Can be abbreviated.</p></td>
    </tr>
    <tr>
      <th>prec</th>
      <td><p>optional character string to specify the measure of precision (only relevant for selection models that can incorporate this into the selection function). Possible options are <code>"sei"</code>, <code>"vi"</code>, <code>"ninv"</code>, or <code>"sqrtninv"</code>. See &#8216;Details&#8217;.</p></td>
    </tr>
    <tr>
      <th>delta</th>
      <td><p>optional numeric vector (of the same length as the number of selection model parameters) to fix the corresponding \(\delta\) value(s). A specific \(\delta\) value can be fixed by setting the corresponding element of this argument to the desired value. A specific \(\delta\) value will be estimated if the corresponding element is set equal to <code>NA</code>. See &#8216;Details&#8217;.</p></td>
    </tr>
    <tr>
      <th>steps</th>
      <td><p>numeric vector of one or more values between 0 and 1 that can or must be specified for certain selection functions. See &#8216;Details&#8217;.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>logical to specify whether output should be generated on the progress of the model fitting (the default is <code>FALSE</code>). Can also be an integer. Values &gt; 1 generate more verbose output. See &#8216;Note&#8217;.</p></td>
    </tr>
    <tr>
      <th>digits</th>
      <td><p>integer to specify the number of decimal places to which the printed results should be rounded (if unspecified, the default is to take the value from the object).</p></td>
    </tr>
    <tr>
      <th>control</th>
      <td><p>optional list of control values for the estimation algorithm. If unspecified, default values are defined inside the function. See &#8216;Note&#8217;.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>other arguments.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Selection models are a general class of models that attempt to model the process by which the studies included in a meta-analysis may have been influenced by some form of publication bias. If a particular selection model is an adequate approximation for the underlying selection process, then the model provides estimates of the parameters of interest (e.g., the average true effect or outcome and the amount of heterogeneity in the true effects or outcomes) that are &#8216;corrected&#8217; for this selection process (i.e., they are estimates of the parameters in the population of studies before any selection has taken place). The present function fits a variety of such selection models. To do so, one should pass an object fitted with the <code><a href='rma.uni.html'>rma.uni</a></code> function to the first argument. The model that will then be fitted is of the same form as the original model combined with the specific selection model chosen (see below for possible options). For example, if the original model was a random-effects model, then a random-effects selection model will be fitted. Similarly, if the original model included moderators, then they will also be included in the selection model. Model fitting is done via maximum likelihood (ML) estimation over the fixed- and random-effects parameters (e.g., \(\mu\) and \(\tau^2\) in a random-effects model) and the selection model parameters.</p>
<p>Argument <code>type</code> determines the specific type of selection model that should be fitted. All selection models that can be fitted are based on the idea that selection may haven taken place based on the p-values of the studies. In particular, let \(y_i\) and \(v_i\) denote the observed effect size or outcome and the corresponding sampling variance of the \(i\)th study. Then \(z_i = y_i / \sqrt{v_i}\) is the (Wald-type) test statistic for testing the null hypothesis \(\mbox{H}_0{:}\; \theta_i = 0\) and \(p_i = 1 - \Phi(z_i)\) (if <code>alternative="greater"</code>), \(p_i = \Phi(z_i)\) (if <code>alternative="less"</code>), or \(p_i = 2(1 - \Phi(|z_i|)\) (if <code>alternative="two.sided"</code>) the corresponding (one- or two-sided) p-value, where \(\Phi()\) denotes the cumulative distribution function of a standard normal distribution. Finally, let \(w(p_i)\) denote some function that specifies the relative likelihood of selection given the p-value of a study.</p>
<p>If \(w(p_i) > w(p_{i'})\) when \(p_i < p_{i'}\) (i.e., \(w(p_i)\) is larger for smaller p-values), then <code>alternative="greater"</code> implies selection in favor of increasingly significant positive effects, <code>alternative="less"</code> implies selection in favor of increasingly significant negative effects, and <code>alternative="two.sided"</code> implies selection in favor of increasingly significant effects regardless of their direction.</p>
<p></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Beta Selection Model</h3>


<p>When <code>type="beta"</code>, the function can be used to fit the &#8216;beta selection model&#8217; by Citkowicz and Vevea (2017). For this model, the selection function is given by \[w(p_i) = p_i^{\delta_1 - 1} \times (1 - p_i)^{\delta_2 - 1}\] where \(\delta_1 > 0\) and \(\delta_2 > 0\). The null hypothesis \(\mbox{H}_0{:}\; \delta_1 = \delta_2 = 1\) represents the case where there is no selection (at least not depending on the p-values).  Note that the model allows for a non-monotonic selection function.</p>
<p><img src='figures/selmodel-beta.png' width=600 /></p>
<p></p>

<p></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Half-Normal, Negative-Exponential, Logistic, and Power Selection Models</h3>


<p>Preston et al. (2004) suggested the first three of the following selection functions:</p>
<p></p><table class='table'>
<tr><td><b>name</b></td><td>&emsp;</td><td><b><code>type</code></b></td><td>&emsp;</td><td><b>selection function</b></td></tr>
<tr><td>half-normal</td><td>&emsp;</td><td><code>"halfnorm"</code></td><td>&emsp;</td><td>\(w(p_i) = \exp(-\delta \times p_i^2)\)</td></tr>
<tr><td>negative-exponential</td><td>&emsp;</td><td><code>"negexp"</code></td><td>&emsp;</td><td>\(w(p_i) = \exp(-\delta \times p_i)\)</td></tr>
<tr><td>logistic</td><td>&emsp;</td><td><code>"logistic"</code></td><td>&emsp;</td><td>\(w(p_i) = 2 \times \exp(-\delta \times p_i) / (1 + \exp(-\delta \times p_i))\)</td></tr>
<tr><td>power</td><td>&emsp;</td><td><code>"power"</code></td><td>&emsp;</td><td>\(w(p_i) = (1-p_i)^\delta\)</td></tr>
</table>


<p>The power selection model is added here as it has similar properties as the models suggested by Preston et al. (2004). For all models, assume \(\delta \ge 0\), so that all functions imply a monotonically decreasing relationship between the p-value and the selection probability. For all functions, \(\mbox{H}_0{:}\; \delta = 0\) implies no selection.</p>
<p><img src='figures/selmodel-preston.png' width=600 /></p>
<p>Here, these functions are extended to allow for the possibility that \(w(p_i) = 1\) for p-values below a certain significance threshold denoted by \(\alpha\) (e.g., to model the case that the relative likelihood of selection is equally high for all significant studies but decreases monotonically for p-values above the significance threshold). To fit such a selection model, one should specify the \(\alpha\) value (with \(0 < \alpha < 1\)) via the <code>steps</code> argument. There must be at least one observed p-value below and above the chosen threshold to fit these models.</p>
<p><img src='figures/selmodel-preston-step.png' width=600 /></p>
<p>Preston et al. (2004) also suggested selection functions where the relatively likelihood of selection not only depends on the p-value, but also the precision (e.g., standard error) of the estimate (if two studies have similar p-values, it may be plausible to assume that the larger / more precise study has a higher probability of selection). These selection functions plus the corresponding power function are given by:</p>
<p></p><table class='table'>
<tr><td><b>name</b></td><td>&emsp;</td><td><b><code>type</code></b></td><td>&emsp;</td><td><b>selection function</b></td></tr>
<tr><td>half-normal</td><td>&emsp;</td><td><code>"halfnorm"</code></td><td>&emsp;</td><td>\(w(p_i) = \exp(-\delta \times \mathrm{prec}_i \times p_i^2)\)</td></tr>
<tr><td>negative-exponential</td><td>&emsp;</td><td><code>"negexp"</code></td><td>&emsp;</td><td>\(w(p_i) = \exp(-\delta \times \mathrm{prec}_i \times p_i)\)</td></tr>
<tr><td>logistic</td><td>&emsp;</td><td><code>"logistic"</code></td><td>&emsp;</td><td>\(w(p_i) = 2 \times \exp(-\delta \times \mathrm{prec}_i \times p_i) / (1 + \exp(-\delta \times \mathrm{prec}_i \times p_i))\)</td></tr>
<tr><td>power</td><td>&emsp;</td><td><code>"power"</code></td><td>&emsp;</td><td>\(w(p_i) = (1-p_i)^{-\delta \times \mathrm{prec}_i}\)</td></tr>
</table>


<p>where \(\mathrm{prec}_i = \sqrt{v_i}\) (i.e., the standard error of the \(i\)th study) according to Preston et al. (2004). Here, this idea is generalized to allow the user to specify the specific measure of precision to use (via the <code>prec</code> argument). Possible options are:</p><ul>
<li><p><code>prec="sei"</code> for the standard errors,</p></li>
<li><p><code>prec="vi"</code> for the sampling variances,</p></li>
<li><p><code>prec="ninv"</code> for the inverse of the sample sizes,</p></li>
<li><p><code>prec="sqrtninv"</code> for the inverse square root of the sample sizes.</p></li>
</ul><p>Using some function of the sample sizes as a measure of precision is only possible when information about the sample sizes is actually stored within the object passed to the <code>selmodel</code> function. See &#8216;Note&#8217;.</p>
<p>Note that \(\mathrm{prec}_i\) is really a measure of imprecision (with higher values corresponding to lower precision). Also, regardless of the specific measure chosen, the values are actually rescaled with \(\mathrm{prec}_i = \mathrm{prec}_i / \max(\mathrm{prec}_i)\) inside of the function, such that \(\mathrm{prec}_i = 1\) for the least precise study and \(\mathrm{prec}_i < 1\) for the remaining studies (the rescaling does not actually change the fit of the model, it only helps to improve the stability of model fitting algorithm).</p>
<p><img src='figures/selmodel-preston-prec.png' width=600 /></p>
<p>One can also use the <code>steps</code> argument as described above in combination with these selection functions (studies with p-values below the chosen cutoff then have \(w(p_i) = 1\) regardless of their exact p-value or precision).</p>
<p></p>

<p></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Negative Exponential Power Selection Model</h3>


<p>As an extension of the half-normal and negative-exponential models, one can also choose <code>type="negexppow"</code> for a &#8216;negative exponential power selection model&#8217;. The selection function is then given by \[w(p_i) = \exp(-\delta_1 \times p_i^{1/\delta_2})\] where \(\delta_1 \ge 0\) and \(\delta_2 \ge 0\) (see Begg &amp; Mazumdar, 1994, although here a different parameterization is used, such that increasing \(\delta_2\) leads to more severe selection).</p>
<p><img src='figures/selmodel-negexppow.png' width=600 /></p>
<p>This model affords greater flexibility in the shape of the selection function, but requires the estimation of the additional power parameter (the half-normal and negative-exponential models are therefore special cases when fixing \(\delta_2\) to 0.5 or 1, respectively). \(\mbox{H}_0{:}\; \delta_1 = 0\) again implies no selection, but so does \(\mbox{H}_0{:}\; \delta_2 = 0\).</p>
<p>One can again use the <code>steps</code> argument to specify a single significance threshold, \(\alpha\), so that \(w(p_i) = 1\) for p-values below this threshold and otherwise \(w(p_i)\) follows the selection function as given above. One can also use the <code>prec</code> argument to specify a measure of precision in combination with this model, which leads to the selection function \[w(p_i) = \exp(-\delta_1 \times \mathrm{prec}_i \times p_i^{1/\delta_2})\] and hence is the logical extension of the negative exponential power selection model that also incorporates some measure of precision into the selection process.</p>
<p></p>

<p></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Step Function Selection Models</h3>


<p>When <code>type="stepfun"</code>, the function can be used to fit &#8216;step function models&#8217; as described by Iyengar and Greenhouse (1988), Hedges (1992), Vevea and Hedges (1995), and Vevea and Woods (2005). For these models, one must specify one or multiple values via the <code>steps</code> argument, which define intervals in which the relative likelihood of selection is constant. Let \[\alpha_1 < \alpha_2 < \ldots < \alpha_c\] denote these cutpoints sorted in increasing order, with the constraint that \(\alpha_c = 1\) (if the highest value specified via <code>steps</code> is not 1, the function will automatically add this cutpoint), and define \(\alpha_0 = 0\). The selection function is then given by \(w(p_i) = \delta_j\) if \(\alpha_{j-1} < p_i \le \alpha_j\). To make the model identifiable, we set \(\delta_1 = 1\). The \(\delta_j\) values therefore denote the likelihood of selection in the various intervals relative to the interval for p-values between 0 and \(\alpha_1\). Hence, the null hypothesis \(\mbox{H}_0{:}\; \delta_j = 1\) for \(j = 1, \ldots, c\) implies no selection.</p>
<p>For example, if <code>steps=c(.05, .10, .50, 1)</code>, then \(\delta_2\) is the likelihood of selection for p-values between .05 and .10, \(\delta_3\) is the likelihood of selection for p-values between .10 and .50, and \(\delta_4\) is the likelihood of selection for p-values between .50 and 1 relative to the likelihood of selection for p-values between 0 and .05.</p>
<p><img src='figures/selmodel-stepfun.png' width=600 /></p>
<p>There must be at least one observed p-value within each interval to fit this model. If this is not the case, an error will be issued (setting <code>verbose=TRUE</code> provides information about the number of p-values falling into each interval).</p>
<p>When applying a single cutoff in the context of a random-effects model, this model is sometimes called the &#8216;three-parameter selection model&#8217; (3PSM), corresponding to the parameters \(\mu\), \(\tau^2\), and \(\delta_2\) (e.g., Carter et al., 2019; McShane et al., 2016; Pustejovsky &amp; Rodgers, 2019). The same idea but in the context of a fixed-effects model was also described by Iyengar and Greenhouse (1988).</p>
<p>Note that when <code>alternative="greater"</code> or <code>alternative="less"</code> (i.e., when we assume that the relative likelihood of selection is not only related to the p-values of the studies, but also the directionality of the effects), then it would usually make sense to divide conventional levels of significance (e.g., .05) by 2 before passing these values to the <code>steps</code> argument. For example, if we think that studies were selected for positive effects that are significant at two-tailed \(\alpha = .05\), then we should use <code>alternative="greater"</code> in combination with <code>steps=c(.025, 1)</code>.</p>
<p>One of the challenges when fitting this model with many cutoffs is the large number of parameters that need to be estimated (which is especially problematic when the number of studies is small). An alternative approach suggested by Vevea and Woods (2005) is to fix the \(\delta_j\) values to some a priori chosen values instead of estimating them. One can then conduct a sensitivity analysis by examining the results (e.g., the estimates of \(\mu\) and \(\tau^2\) in a random-effects model) for a variety of different sets of \(\delta_j\) values (reflecting more or less severe forms of selection). This can be done by specifying the \(\delta_j\) values via the <code>delta</code> argument. Table 1 in Vevea and Woods (2005) provides some illustrative examples of moderate and severe selection functions for one- and two-tailed selection. The code below creates a data frame that contains these functions.</p>
<p></p><pre><span class='va'>tab</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>
   steps <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.005</span>, <span class='fl'>0.01</span>, <span class='fl'>0.05</span>, <span class='fl'>0.10</span>, <span class='fl'>0.25</span>, <span class='fl'>0.35</span>, <span class='fl'>0.50</span>, <span class='fl'>0.65</span>, <span class='fl'>0.75</span>, <span class='fl'>0.90</span>, <span class='fl'>0.95</span>, <span class='fl'>0.99</span>, <span class='fl'>0.995</span>, <span class='fl'>1</span><span class='op'>)</span>,
   delta.mod.1 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>0.99</span>, <span class='fl'>0.95</span>, <span class='fl'>0.80</span>, <span class='fl'>0.75</span>, <span class='fl'>0.65</span>, <span class='fl'>0.60</span>, <span class='fl'>0.55</span>, <span class='fl'>0.50</span>, <span class='fl'>0.50</span>, <span class='fl'>0.50</span>, <span class='fl'>0.50</span>, <span class='fl'>0.50</span>, <span class='fl'>0.50</span><span class='op'>)</span>,
   delta.sev.1 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>0.99</span>, <span class='fl'>0.90</span>, <span class='fl'>0.75</span>, <span class='fl'>0.60</span>, <span class='fl'>0.50</span>, <span class='fl'>0.40</span>, <span class='fl'>0.35</span>, <span class='fl'>0.30</span>, <span class='fl'>0.25</span>, <span class='fl'>0.10</span>, <span class='fl'>0.10</span>, <span class='fl'>0.10</span>, <span class='fl'>0.10</span><span class='op'>)</span>,
   delta.mod.2 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>0.99</span>, <span class='fl'>0.95</span>, <span class='fl'>0.90</span>, <span class='fl'>0.80</span>, <span class='fl'>0.75</span>, <span class='fl'>0.60</span>, <span class='fl'>0.60</span>, <span class='fl'>0.75</span>, <span class='fl'>0.80</span>, <span class='fl'>0.90</span>, <span class='fl'>0.95</span>, <span class='fl'>0.99</span>, <span class='fl'>1.00</span><span class='op'>)</span>,
   delta.sev.2 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>0.99</span>, <span class='fl'>0.90</span>, <span class='fl'>0.75</span>, <span class='fl'>0.60</span>, <span class='fl'>0.50</span>, <span class='fl'>0.25</span>, <span class='fl'>0.25</span>, <span class='fl'>0.50</span>, <span class='fl'>0.60</span>, <span class='fl'>0.75</span>, <span class='fl'>0.90</span>, <span class='fl'>0.99</span>, <span class='fl'>1.00</span><span class='op'>)</span><span class='op'>)</span></pre>

<p></p>
<p><img src='figures/selmodel-stepfun-fixed.png' width=600 /></p>
<p>These four functions are &#8220;merely examples and should not be regarded as canonical&#8221; (Vevea &amp; Woods, 2005).</p>
<p></p>


    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <code><a href='https://rdrr.io/r/base/c.html'>c("rma.uni","rma")</a></code>. The object is a list containing the same components as a regular <code><a href='https://rdrr.io/r/base/c.html'>c("rma.uni","rma")</a></code> object, but the parameter estimates are based on the selection model. Most importantly, the following elements are modified based on the selection model:</p>
<dt>beta</dt><dd><p>estimated coefficients of the model.</p></dd>
   <dt>se</dt><dd><p>standard errors of the coefficients.</p></dd>
   <dt>zval</dt><dd><p>test statistics of the coefficients.</p></dd>
   <dt>pval</dt><dd><p>corresponding p-values.</p></dd>
   <dt>ci.lb</dt><dd><p>lower bound of the confidence intervals for the coefficients.</p></dd>
   <dt>ci.ub</dt><dd><p>upper bound of the confidence intervals for the coefficients.</p></dd>
   <dt>vb</dt><dd><p>variance-covariance matrix of the estimated coefficients.</p></dd>
   <dt>tau2</dt><dd><p>estimated amount of (residual) heterogeneity. Always <code>0</code> when <code>method="FE"</code>.</p></dd>
   <dt>se.tau2</dt><dd><p>standard error of the estimated amount of (residual) heterogeneity.</p></dd>
   In addition, the object contains the following additional elements:
   <dt>delta</dt><dd><p>estimated selection model parameter(s).</p></dd>
   <dt>se.delta</dt><dd><p>corresponding standard error(s).</p></dd>
   <dt>zval.delta</dt><dd><p>corresponding test statistic(s).</p></dd>
   <dt>pval.delta</dt><dd><p>corresponding p-value(s).</p></dd>
   <dt>ci.lb.delta</dt><dd><p>lower bound of the confidence intervals for the parameter(s).</p></dd>
   <dt>ci.ub.delta</dt><dd><p>upper bound of the confidence intervals for the parameter(s).</p></dd>
   <dt>LRT</dt><dd><p>test statistic of the likelihood ratio test for the selection model parameter(s).</p></dd>
   <dt>LRTdf</dt><dd><p>degrees of freedom for the likelihood ratio test.</p></dd>
   <dt>LRTp</dt><dd><p>p-value for the likelihood ratio test.</p></dd>
   <dt>LRT.tau2</dt><dd><p>test statistic of the likelihood ratio test for testing \(H_0: \tau^2 = 0\) (<code>NA</code> when fitting a fixed-effects model).</p></dd>
   <dt>LRTp.tau2</dt><dd><p>p-value for the likelihood ratio test.</p></dd>
   <dt>...</dt><dd><p>some additional elements/values.</p></dd>

   The results of the fitted model are formatted and printed with the <a href='print.rma.html'>print.rma.uni</a> function. The estimated selection function can be drawn with <a href='plot.rma.uni.selmodel.html'>plot.rma.uni.selmodel</a>.

    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Model fitting is done via numerical optimization over the model parameters. By default, <code><a href='https://rdrr.io/r/stats/optim.html'>optim</a></code> is used for the optimization. One can also chose a different optimizer via the <code>control</code> argument (e.g., <code>control=list(optimizer="nlminb")</code>). When using <code><a href='https://rdrr.io/r/stats/optim.html'>optim</a></code>, one can set the particular method via the <code>optmethod</code> argument (e.g., <code>control=list(optimizer="optim", optmethod="BFGS")</code>, which is the default). Besides <code><a href='https://rdrr.io/r/stats/optim.html'>optim</a></code> and <code><a href='https://rdrr.io/r/stats/nlminb.html'>nlminb</a></code>, one can also choose one of the optimizers from the <code>minqa</code> package (i.e., <code><a href='https://rdrr.io/pkg/minqa/man/uobyqa.html'>uobyqa</a></code>, <code><a href='https://rdrr.io/pkg/minqa/man/newuoa.html'>newuoa</a></code>, or <code><a href='https://rdrr.io/pkg/minqa/man/bobyqa.html'>bobyqa</a></code>), one of the (derivative-free) algorithms from the <code><a href='https://rdrr.io/pkg/nloptr/man/nloptr.html'>nloptr</a></code> package, the Newton-type algorithm implemented in <code><a href='https://rdrr.io/r/stats/nlm.html'>nlm</a></code>, the Hooke-Jeeves and Nelder-Mead algorithms as implemented in <code><a href='https://rdrr.io/pkg/dfoptim/man/hookejeeves.html'>hjk</a></code> and <code><a href='https://rdrr.io/pkg/dfoptim/man/nmkb.html'>nmk</a></code> from the <code>dfoptim</code> package, the quasi-Newton type optimizer <code><a href='https://rdrr.io/pkg/ucminf/man/ucminf.html'>ucminf</a></code> from the package of the same name, or the parallelized version of the L-BFGS-B algorithm implemented in <code><a href='https://rdrr.io/pkg/optimParallel/man/optimParallel.html'>optimParallel</a></code> from the package of the same name.</p>
<p>The optimizer name must be given as a character string (i.e., in quotes). Additional control parameters can be specified via the <code>control</code> argument (e.g., <code>control=list(maxit=1000, reltol=1e-8)</code>). For <code><a href='https://rdrr.io/pkg/nloptr/man/nloptr.html'>nloptr</a></code>, the default is to use the BOBYQA implementation from that package with a relative convergence criterion of <code>1e-8</code> on the function value (i.e., log-likelihood), but this can be changed via the <code>algorithm</code> and <code>ftop_rel</code> arguments (e.g., <code>control=list(optimizer="nloptr", algorithm="NLOPT_LN_SBPLX", ftol_rel=1e-6)</code>). For <code><a href='https://rdrr.io/pkg/optimParallel/man/optimParallel.html'>optimParallel</a></code>, the control argument <code>ncpus</code> can be used to specify the number of cores to use for the parallelization (e.g., <code>control=list(optimizer="optimParallel", ncpus=2)</code>). With <code><a href='https://rdrr.io/r/parallel/detectCores.html'>parallel::detectCores()</a></code>, one can check on the number of available cores on the local machine.</p>
<p>All selection models (except for <code>type="stepfun"</code>) require repeated evaluations of an integral, which is done via adaptive quadrature as implemented in the <code><a href='https://rdrr.io/r/stats/integrate.html'>integrate</a></code> function. One can adjust the arguments of the <code>integrate</code> function via control element <code>intCtrl</code>, which is a list of named arguments (e.g., <code>control = list(intCtrl = list(rel.tol=1e-4, subdivisions=100))</code>).</p>
<p>The starting values for the fixed effects, the \(\tau^2\) value (only relevant in random/mixed-effects models), and the \(\delta\) parameter(s) are chosen automatically by the function, but one can also set the starting values manually via the <code>control</code> argument by specifying a vector of the appropriate length for <code>beta.init</code>, a single value for <code>tau2.init</code>, and a vector of the appropriate length for <code>delta.init</code>.</p>
<p>By default, the \(\delta\) parameter(s) are constrained to a certain range, which improves the stability of the optimization algorithm. For all models, the maximum is set to <code>100</code> and the minimum to <code>0</code> (except for <code>type="beta"</code>, where the minimum for both parameters is <code>1e-05</code>). These defaults can be changed via the <code>control</code> argument by specifying a vector of the appropriate length for <code>delta.min</code> and/or <code>delta.max</code>.</p>
<p>A difficulty with fitting the beta selection model (i.e., <code>type="beta"</code>) is the behavior of \(w(p_i)\) when \(p_i = 0\) or \(p_i = 1\). When \(\delta_1 < 1\) or \(\delta_2 < 1\), then this leads to selection weights equal to infinity, which causes problems when computing the likelihood function. Following Citkowicz and Vevea (2017), this problem can be avoided by censoring p-values too close to 0 or 1. The specific censoring point can be set via the <code>pval.min</code> element of the <code>control</code> argument. The default for this selection model is <code>control=list(pval.min=1e-5)</code> (for all other selection models, the default is <code>pval.min=0</code>).</p>
<p>The variance-covariance matrix corresponding to the estimates of the fixed effects, the \(\tau^2\) value (only relevant in random/mixed-effects models), and the \(\delta\) parameter(s) is obtained by inverting the Hessian, which is numerically approximated using the <code><a href='https://rdrr.io/pkg/numDeriv/man/hessian.html'>hessian</a></code> function. This may fail, leading to <code>NA</code> values for the standard errors and hence test statistics, p-values, and confidence interval bounds. One can set control argument <code>hessianCtrl</code> to a list of named arguments to be passed on to the <code>method.args</code> argument of the <code><a href='https://rdrr.io/pkg/numDeriv/man/hessian.html'>hessian</a></code> function (the default is <code>control=list(hessianCtrl=list(r=6))</code>).</p>
<p>Information on the progress of the optimization algorithm can be obtained by setting <code>verbose=TRUE</code> (this won't work when using parallelization). This option is useful to determine how the model fitting is progressing. One can also set <code>verbose</code> to an integer (<code>verbose=2</code> yields even more information and <code>verbose=3</code> also show the progress visually by drawing the selection function as the optimization proceeds).</p>
<p>For selection functions where the <code>prec</code> argument is relevant, using (a function of) the sample sizes as the measure of precision (i.e., <code>prec="ninv"</code> or <code>prec="sqrtninv"</code>) is only possible when information about the sample sizes is actually stored within the object passed to the <code>selmodel</code> function. That should automatically be the case when the observed effect sizes or outcomes were computed with the <code><a href='escalc.html'>escalc</a></code> function or when the observed effect sizes or outcomes were computed within the model fitting function. On the other hand, this will not be the case when <code><a href='rma.uni.html'>rma.uni</a></code> was used together with the <code>yi</code> and <code>vi</code> arguments and the <code>yi</code> and <code>vi</code> values were <em>not</em> computed with <code><a href='escalc.html'>escalc</a></code>. In that case, it is still possible to pass information about the sample sizes to the <code><a href='rma.uni.html'>rma.uni</a></code> function (e.g., use <code><a href='rma.uni.html'>rma.uni(yi, vi, ni=ni, data=dat)</a></code>, where data frame <code>dat</code> includes a variable called <code>ni</code> with the sample sizes).</p>
<p>Finally, the automatic rescaling of the chosen precision measure can be switched off by setting <code>scaleprec=FALSE</code>.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Wolfgang Viechtbauer <a href='mailto:wvb@metafor-project.org'>wvb@metafor-project.org</a> <a href='http://www.metafor-project.org'>http://www.metafor-project.org</a></p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Begg, C. B., &amp; Mazumdar, M. (1994). Operating characteristics of a rank correlation test for publication bias. <em>Biometrics</em>, <b>50</b>(4), 1088--1101. <a href='https://doi.org/10.2307/2533446'>https://doi.org/10.2307/2533446</a></p>
<p>Carter, E. C., Schönbrodt, F. D., Gervais, W. M., &amp; Hilgard, J. (2019). Correcting for bias in psychology: A comparison of meta-analytic methods. <em>Advances in Methods and Practices in Psychological Science</em>, <b>2</b>(2), 115--144. <a href='https://doi.org/10.1177/2515245919847196'>https://doi.org/10.1177/2515245919847196</a></p>
<p>Citkowicz, M., &amp; Vevea, J. L. (2017). A parsimonious weight function for modeling publication bias. <em>Psychological Methods</em>, <b>22</b>(1), 28--41. <a href='https://doi.org/10.1037/met0000119'>https://doi.org/10.1037/met0000119</a></p>
<p>Hedges, L. V. (1992). Modeling publication selection effects in meta-analysis. <em>Statistical Science</em>, <b>7</b>(2), 246--255. <a href='https://doi.org/10.1214/ss/1177011364'>https://doi.org/10.1214/ss/1177011364</a></p>
<p>Iyengar, S., &amp; Greenhouse, J. B. (1988). Selection models and the file drawer problem. <em>Statistical Science</em>, <b>3</b>(1), 109--117. <a href='https://doi.org/10.1214/ss/1177013012'>https://doi.org/10.1214/ss/1177013012</a></p>
<p>McShane, B. B., Bockenholt, U., &amp; Hansen, K. T. (2016). Adjusting for publication bias in meta-analysis: An evaluation of selection methods and some cautionary notes. <em>Perspectives on Psychological Science</em>, <b>11</b>(5), 730--749. <a href='https://doi.org/10.1177/1745691616662243'>https://doi.org/10.1177/1745691616662243</a></p>
<p>Preston, C., Ashby, D., &amp; Smyth, R. (2004). Adjusting for publication bias: Modelling the selection process. <em>Journal of Evaluation in Clinical Practice</em>, <b>10</b>(2), 313--322. <a href='https://doi.org/10.1111/j.1365-2753.2003.00457.x'>https://doi.org/10.1111/j.1365-2753.2003.00457.x</a></p>
<p>Pustejovsky, J. E., &amp; Rodgers, M. A. (2019). Testing for funnel plot asymmetry of standardized mean differences. <em>Research Synthesis Methods</em>, <b>10</b>(1), 57--71. <a href='https://doi.org/10.1002/jrsm.1332'>https://doi.org/10.1002/jrsm.1332</a></p>
<p>Vevea, J. L., &amp; Hedges, L. V. (1995). A general linear model for estimating effect size in the presence of publication bias. <em>Psychometrika</em>, <b>60</b>(3), 419--435. <a href='https://doi.org/10.1007/BF02294384'>https://doi.org/10.1007/BF02294384</a></p>
<p>Vevea, J. L., &amp; Woods, C. M. (2005). Publication bias in research synthesis: Sensitivity analysis using a priori weight functions. <em>Psychological Methods</em>, <b>10</b>(4), 428--443. <a href='https://doi.org/10.1037/1082-989X.10.4.428'>https://doi.org/10.1037/1082-989X.10.4.428</a></p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='rma.uni.html'>rma.uni</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>############################################################################</span>

<span class='co'>### example from Citkowicz and Vevea (2017) for beta selection model</span>

<span class='co'># copy data into 'dat' and examine data</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='va'>dat.baskerville2012</span>
<span class='va'>dat</span>
</div><div class='output co'>#&gt;              author year score design alloconc blind itt fumonths retention
#&gt; 1     Kottke et al. 1992     6    cct        0     1   1       19      83.0
#&gt; 2    McBride et al. 2000     6    rct        0     0   0       18     100.0
#&gt; 3     Stange et al. 2000     6    rct        0     0   0       24        NA
#&gt; 4       Lobo et al. 2004     6    rct        1     0   0       21      57.0
#&gt; 5  Roetzhiem et al. 2005     6   crct        0     1   0       24     100.0
#&gt; 6       Hogg et al. 2008     6    cct        0     0   1        6      87.0
#&gt; 7       Aspy et al. 2008     6    cct        0     1   0       18      89.0
#&gt; 8       Jaen et al. 2010     6    rct        0     1   0       26      86.0
#&gt; 9   Cockburn et al. 1992     7    rct        0     0   0        3      79.0
#&gt; 10    Modell et al. 1998     7    rct        0     0   0       12     100.0
#&gt; 11    Engels et al. 2006     7    rct        1     0   1       12      92.0
#&gt; 12      Aspy et al. 2008     7    rct        0     1   0        9     100.0
#&gt; 13  Deitrich et al. 1992    18    rct        0     1   0       12      96.0
#&gt; 14      Lobo et al. 2002     8    rct        1     0   1       21     100.0
#&gt; 15     Bryce et al. 1995     9    rct        1     1   1       12      93.3
#&gt; 16 Kinsinger et al. 1998     9    rct        1     1   0       18      94.0
#&gt; 17   Solberg et al. 1998     9    rct        1     0   1       22     100.0
#&gt; 18   Lemelin et al. 2001     9    rct        1     1   0       18      98.0
#&gt; 19  Frijling et al. 2002     9   crct        1     1   1       21      95.0
#&gt; 20  Frijling et al. 2003     9   crct        1     1   1       21      95.0
#&gt; 21  Margolis et al. 2004    10    rct        1     1   1       30     100.0
#&gt; 22      Mold et al. 2008    10    rct        1     1   1        6     100.0
#&gt; 23      Hogg et al. 2008    12    rct        1     1   1       13     100.0
#&gt;    country outcomes duration pperf meetings hours tailor  smd   se
#&gt; 1       US        2       18   5.5     30.0  1.00      1 1.01 0.52
#&gt; 2       US        4       12    NA      5.0  1.00      1 0.82 0.46
#&gt; 3       US       35       12  20.0      4.0  1.50      1 0.59 0.23
#&gt; 4       NL       16       21   5.0     15.0  1.00      1 0.44 0.18
#&gt; 5       US        3       24   4.0      4.0  1.00      0 0.84 0.29
#&gt; 6      Can       26       12  11.0     12.0  1.50      1 0.73 0.29
#&gt; 7       US        4       18   3.0      3.0  6.00      1 1.12 0.36
#&gt; 8       US       11       26   6.0      4.5  6.00      1 0.04 0.37
#&gt; 9      Aus        2        2  40.0      2.0  0.25      0 0.24 0.15
#&gt; 10      UK        1       12  13.0      3.0  1.00      0 0.32 0.40
#&gt; 11      NL        7        5    NA      5.0  1.00      1 1.04 0.32
#&gt; 12      US        1        9   6.0     18.0  6.00      1 1.31 0.57
#&gt; 13      NL       16       21  20.0     15.0  1.00      1 0.59 0.29
#&gt; 14      US       10        3   8.0      3.0  1.00      1 0.66 0.19
#&gt; 15      US        4       12  12.0      1.0 15.00      0 0.62 0.31
#&gt; 16      US        5       12  13.0     10.0  0.75      1 0.47 0.27
#&gt; 17      US       10       22  11.0      4.0  3.00      1 1.08 0.32
#&gt; 18     Can       13       18   8.0     33.0  1.75      1 0.98 0.32
#&gt; 19      NL        7       21  20.0     15.0  1.00      0 0.26 0.18
#&gt; 20      NL       12       21  20.0     15.0  1.00      1 0.39 0.18
#&gt; 21      US        4       24  11.0      9.0  1.00      1 0.60 0.31
#&gt; 22      US        6        6   8.0     18.0  4.00      1 0.94 0.53
#&gt; 23     Can       53       12  14.0      9.0  0.75      1 0.11 0.27</div><div class='input'>
<span class='co'># fit random-effects model</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'><a href='rma.uni.html'>rma</a></span><span class='op'>(</span><span class='va'>smd</span>, <span class='va'>se</span><span class='op'>^</span><span class='fl'>2</span>, data<span class='op'>=</span><span class='va'>dat</span>, method<span class='op'>=</span><span class='st'>"ML"</span>, digits<span class='op'>=</span><span class='fl'>3</span><span class='op'>)</span>
<span class='va'>res</span>
</div><div class='output co'>#&gt; 
#&gt; Random-Effects Model (k = 23; tau^2 estimator: ML)
#&gt; 
#&gt; tau^2 (estimated amount of total heterogeneity): 0.016 (SE = 0.024)
#&gt; tau (square root of estimated tau^2 value):      0.127
#&gt; I^2 (total heterogeneity / total variability):   18.64%
#&gt; H^2 (total variability / sampling variability):  1.23
#&gt; 
#&gt; Test for Heterogeneity:
#&gt; Q(df = 22) = 27.552, p-val = 0.191
#&gt; 
#&gt; Model Results:
#&gt; 
#&gt; estimate     se   zval   pval  ci.lb  ci.ub 
#&gt;    0.555  0.063  8.775  &lt;.001  0.431  0.679  *** 
#&gt; 
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
#&gt; </div><div class='input'>
<span class='co'># funnel plot</span>
<span class='fu'><a href='funnel.html'>funnel</a></span><span class='op'>(</span><span class='va'>res</span>, ylim<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0.6</span><span class='op'>)</span>, xlab<span class='op'>=</span><span class='st'>"Standardized Mean Difference"</span><span class='op'>)</span>
</div><div class='img'><img src='selmodel-1.png' alt='' width='768' height='614' /></div><div class='input'>
<span class='co'># fit beta selection model</span>
<span class='co'># \dontrun{</span>
<span class='va'>sel</span> <span class='op'>&lt;-</span> <span class='fu'>selmodel</span><span class='op'>(</span><span class='va'>res</span>, type<span class='op'>=</span><span class='st'>"beta"</span><span class='op'>)</span>
<span class='va'>sel</span>
</div><div class='output co'>#&gt; 
#&gt; Random-Effects Model (k = 23; tau^2 estimator: ML)
#&gt; 
#&gt; tau^2 (estimated amount of total heterogeneity): 0.000 (SE = 0.001)
#&gt; tau (square root of estimated tau^2 value):      0.002
#&gt; 
#&gt; Test for Heterogeneity:
#&gt; LRT(df = 1) = 0.009, p-val = 0.925
#&gt; 
#&gt; Model Results:
#&gt; 
#&gt; estimate     se   zval   pval   ci.lb  ci.ub 
#&gt;    0.115  0.166  0.689  0.491  -0.212  0.441    
#&gt; 
#&gt; Test for Selection Model Parameters:
#&gt; LRT(df = 2) = 7.847, p-val = 0.020
#&gt; 
#&gt; Selection Model Results:
#&gt; 
#&gt;          estimate     se    zval   pval  ci.lb  ci.ub 
#&gt; delta.1     0.473  0.235  -2.240  0.025  0.012  0.934  * 
#&gt; delta.2     4.461  2.185   1.584  0.113  0.180  8.743    
#&gt; 
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
#&gt; </div><div class='input'>
<span class='co'># plot selection function</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>sel</span>, ylim<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>40</span><span class='op'>)</span><span class='op'>)</span><span class='co'># }</span>
</div><div class='img'><img src='selmodel-2.png' alt='' width='768' height='614' /></div><div class='input'>
<span class='co'># fit mixed-effects meta-regression model with 'blind' dummy variable as moderator</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'><a href='rma.uni.html'>rma</a></span><span class='op'>(</span><span class='va'>smd</span>, <span class='va'>se</span><span class='op'>^</span><span class='fl'>2</span>, data<span class='op'>=</span><span class='va'>dat</span>, mods <span class='op'>=</span> <span class='op'>~</span> <span class='va'>blind</span>, method<span class='op'>=</span><span class='st'>"ML"</span>, digits<span class='op'>=</span><span class='fl'>3</span><span class='op'>)</span>
<span class='va'>res</span>
</div><div class='output co'>#&gt; 
#&gt; Mixed-Effects Model (k = 23; tau^2 estimator: ML)
#&gt; 
#&gt; tau^2 (estimated amount of residual heterogeneity):     0.016 (SE = 0.024)
#&gt; tau (square root of estimated tau^2 value):             0.128
#&gt; I^2 (residual heterogeneity / unaccounted variability): 18.26%
#&gt; H^2 (unaccounted variability / sampling variability):   1.22
#&gt; R^2 (amount of heterogeneity accounted for):            0.00%
#&gt; 
#&gt; Test for Residual Heterogeneity:
#&gt; QE(df = 21) = 27.503, p-val = 0.155
#&gt; 
#&gt; Test of Moderators (coefficient 2):
#&gt; QM(df = 1) = 0.069, p-val = 0.792
#&gt; 
#&gt; Model Results:
#&gt; 
#&gt;          estimate     se    zval   pval   ci.lb  ci.ub 
#&gt; intrcpt     0.573  0.093   6.192  &lt;.001   0.392  0.754  *** 
#&gt; blind      -0.033  0.127  -0.263  0.792  -0.282  0.215      
#&gt; 
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
#&gt; </div><div class='input'>
<span class='co'># predicted average effect for studies that do not and that do use blinding</span>
<span class='fu'><a href='predict.rma.html'>predict</a></span><span class='op'>(</span><span class='va'>res</span>, newmods<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt;    pred    se ci.lb ci.ub pi.lb pi.ub 
#&gt; 1 0.573 0.093 0.392 0.754 0.264 0.882 
#&gt; 2 0.540 0.087 0.370 0.710 0.237 0.842 
#&gt; </div><div class='input'>
<span class='co'># fit beta selection model</span>
<span class='co'># \dontrun{</span>
<span class='va'>sel</span> <span class='op'>&lt;-</span> <span class='fu'>selmodel</span><span class='op'>(</span><span class='va'>res</span>, type<span class='op'>=</span><span class='st'>"beta"</span><span class='op'>)</span>
<span class='va'>sel</span>
</div><div class='output co'>#&gt; 
#&gt; Mixed-Effects Model (k = 23; tau^2 estimator: ML)
#&gt; 
#&gt; tau^2 (estimated amount of residual heterogeneity):     0.000 (SE = 0.000)
#&gt; tau (square root of estimated tau^2 value):             0.001
#&gt; 
#&gt; Test for Residual Heterogeneity:
#&gt; LRT(df = 1) = 0.000, p-val = 1.000
#&gt; 
#&gt; Test of Moderators (coefficient 2):
#&gt; QM(df = 1) = 1.201, p-val = 0.273
#&gt; 
#&gt; Model Results:
#&gt; 
#&gt;          estimate     se    zval   pval   ci.lb  ci.ub 
#&gt; intrcpt     0.134  0.171   0.787  0.432  -0.200  0.469    
#&gt; blind      -0.136  0.124  -1.096  0.273  -0.380  0.108    
#&gt; 
#&gt; Test for Selection Model Parameters:
#&gt; LRT(df = 2) = 9.044, p-val = 0.011
#&gt; 
#&gt; Selection Model Results:
#&gt; 
#&gt;          estimate     se    zval   pval  ci.lb  ci.ub 
#&gt; delta.1     0.420  0.239  -2.425  0.015  0.000  0.889  * 
#&gt; delta.2     5.096  2.411   1.699  0.089  0.371  9.821  . 
#&gt; 
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
#&gt; </div><div class='input'><span class='fu'><a href='predict.rma.html'>predict</a></span><span class='op'>(</span><span class='va'>sel</span>, newmods<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span><span class='co'># }</span>
</div><div class='output co'>#&gt; 
#&gt;     pred    se  ci.lb ci.ub  pi.lb pi.ub 
#&gt; 1  0.134 0.171 -0.200 0.469 -0.200 0.469 
#&gt; 2 -0.002 0.199 -0.392 0.388 -0.392 0.388 
#&gt; </div><div class='input'>
<span class='co'>############################################################################</span>

<span class='co'>### example from Preston et al. (2004)</span>

<span class='co'># copy data into 'dat' and examine data</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='va'>dat.hahn2001</span>
<span class='va'>dat</span>
</div><div class='output co'>#&gt;               study ai n1i ci n2i
#&gt; 1  Banhladesh 1995a  4  19  5  19
#&gt; 2  Banhladesh 1996a  0  18  0  18
#&gt; 3       CHOICE 2001 34 341 50 334
#&gt; 4     Colombia 2000  7  71 16  69
#&gt; 5       Egypt 1886a  6  45  5  44
#&gt; 6       Egypt 1996b  1  94  8  96
#&gt; 7       India 1984a  0  22  0  22
#&gt; 8       India 2000b 11  88 12  82
#&gt; 9      Mexico 1990a  2  82  7  84
#&gt; 10      Panama 1982  0  33  0  30
#&gt; 11         USA 1982  0  15  1  20
#&gt; 12         WHO 1995 33 221 43 218</div><div class='input'>
<span class='co'>### meta-analysis of (log) odds rations using the Mantel-Haenszel method</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'><a href='rma.mh.html'>rma.mh</a></span><span class='op'>(</span>measure<span class='op'>=</span><span class='st'>"OR"</span>, ai<span class='op'>=</span><span class='va'>ai</span>, n1i<span class='op'>=</span><span class='va'>n1i</span>, ci<span class='op'>=</span><span class='va'>ci</span>, n2i<span class='op'>=</span><span class='va'>n2i</span>, data<span class='op'>=</span><span class='va'>dat</span>, digits<span class='op'>=</span><span class='fl'>2</span>, slab<span class='op'>=</span><span class='va'>study</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: Some yi/vi values are NA.</span></div><div class='input'><span class='va'>res</span>
</div><div class='output co'>#&gt; 
#&gt; Fixed-Effects Model (k = 12)
#&gt; 
#&gt; I^2 (total heterogeneity / total variability):  0.00%
#&gt; H^2 (total variability / sampling variability): 0.82
#&gt; 
#&gt; Test for Heterogeneity: 
#&gt; Q(df = 8) = 6.53, p-val = 0.59
#&gt; 
#&gt; Model Results (log scale):
#&gt; 
#&gt; estimate    se   zval  pval  ci.lb  ci.ub 
#&gt;    -0.49  0.14  -3.51  &lt;.01  -0.77  -0.22 
#&gt; 
#&gt; Model Results (OR scale):
#&gt; 
#&gt; estimate  ci.lb  ci.ub 
#&gt;     0.61   0.46   0.80 
#&gt; 
#&gt; Cochran-Mantel-Haenszel Test:    CMH = 12.00, df = 1, p-val &lt; 0.01
#&gt; Tarone's Test for Heterogeneity: X^2 =  7.58, df = 8, p-val = 0.48
#&gt; </div><div class='input'>
<span class='co'># calculate log odds ratios and corresponding sampling variances</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='escalc.html'>escalc</a></span><span class='op'>(</span>measure<span class='op'>=</span><span class='st'>"OR"</span>, ai<span class='op'>=</span><span class='va'>ai</span>, n1i<span class='op'>=</span><span class='va'>n1i</span>, ci<span class='op'>=</span><span class='va'>ci</span>, n2i<span class='op'>=</span><span class='va'>n2i</span>, data<span class='op'>=</span><span class='va'>dat</span>, drop00<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>dat</span>
</div><div class='output co'>#&gt;               study ai n1i ci n2i      yi     vi 
#&gt; 1  Banhladesh 1995a  4  19  5  19 -0.2921 0.5881 
#&gt; 2  Banhladesh 1996a  0  18  0  18      NA     NA 
#&gt; 3       CHOICE 2001 34 341 50 334 -0.4635 0.0562 
#&gt; 4     Colombia 2000  7  71 16  69 -1.0153 0.2399 
#&gt; 5       Egypt 1886a  6  45  5  44  0.1823 0.4179 
#&gt; 6       Egypt 1996b  1  94  8  96 -2.1347 1.1471 
#&gt; 7       India 1984a  0  22  0  22      NA     NA 
#&gt; 8       India 2000b 11  88 12  82 -0.1823 0.2015 
#&gt; 9      Mexico 1990a  2  82  7  84 -1.2910 0.6683 
#&gt; 10      Panama 1982  0  33  0  30      NA     NA 
#&gt; 11         USA 1982  0  15  1  20 -0.8690 2.7825 
#&gt; 12         WHO 1995 33 221 43 218 -0.3363 0.0646 </div><div class='input'>
<span class='co'># fit fixed-effects model</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'><a href='rma.uni.html'>rma</a></span><span class='op'>(</span><span class='va'>yi</span>, <span class='va'>vi</span>, data<span class='op'>=</span><span class='va'>dat</span>, method<span class='op'>=</span><span class='st'>"FE"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: Studies with NAs omitted from model fitting.</span></div><div class='input'>
<span class='co'># predicted odds ratio (with 95% CI)</span>
<span class='fu'><a href='predict.rma.html'>predict</a></span><span class='op'>(</span><span class='va'>res</span>, transf<span class='op'>=</span><span class='va'>exp</span>, digits<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt;  pred ci.lb ci.ub 
#&gt;  0.63  0.48  0.83 
#&gt; </div><div class='input'>
<span class='co'># funnel plot</span>
<span class='fu'><a href='funnel.html'>funnel</a></span><span class='op'>(</span><span class='va'>res</span>, atransf<span class='op'>=</span><span class='va'>exp</span>, at<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.01</span>, <span class='fl'>0.1</span>, <span class='fl'>1</span>, <span class='fl'>10</span>, <span class='fl'>100</span><span class='op'>)</span><span class='op'>)</span>, ylim<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='selmodel-3.png' alt='' width='768' height='614' /></div><div class='input'>
<span class='co'># fit half-normal, negative-exponential, logistic, and power selection models</span>
<span class='va'>sel1</span> <span class='op'>&lt;-</span> <span class='fu'>selmodel</span><span class='op'>(</span><span class='va'>res</span>, type<span class='op'>=</span><span class='st'>"halfnorm"</span>, alternative<span class='op'>=</span><span class='st'>"less"</span><span class='op'>)</span>
<span class='va'>sel2</span> <span class='op'>&lt;-</span> <span class='fu'>selmodel</span><span class='op'>(</span><span class='va'>res</span>, type<span class='op'>=</span><span class='st'>"negexp"</span>,   alternative<span class='op'>=</span><span class='st'>"less"</span><span class='op'>)</span>
<span class='va'>sel3</span> <span class='op'>&lt;-</span> <span class='fu'>selmodel</span><span class='op'>(</span><span class='va'>res</span>, type<span class='op'>=</span><span class='st'>"logistic"</span>, alternative<span class='op'>=</span><span class='st'>"less"</span><span class='op'>)</span>
<span class='va'>sel4</span> <span class='op'>&lt;-</span> <span class='fu'>selmodel</span><span class='op'>(</span><span class='va'>res</span>, type<span class='op'>=</span><span class='st'>"power"</span>,    alternative<span class='op'>=</span><span class='st'>"less"</span><span class='op'>)</span>

<span class='co'># plot selection functions</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>sel1</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>sel2</span>, add<span class='op'>=</span><span class='cn'>TRUE</span>, col<span class='op'>=</span><span class='st'>"blue"</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>sel3</span>, add<span class='op'>=</span><span class='cn'>TRUE</span>, col<span class='op'>=</span><span class='st'>"red"</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>sel4</span>, add<span class='op'>=</span><span class='cn'>TRUE</span>, col<span class='op'>=</span><span class='st'>"green"</span><span class='op'>)</span>
</div><div class='img'><img src='selmodel-4.png' alt='' width='768' height='614' /></div><div class='input'>
<span class='co'># show estimates of delta (and corresponding SEs)</span>
<span class='va'>tab</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>delta <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>sel1</span><span class='op'>$</span><span class='va'>delta</span>, <span class='va'>sel2</span><span class='op'>$</span><span class='va'>delta</span>, <span class='va'>sel3</span><span class='op'>$</span><span class='va'>delta</span>, <span class='va'>sel4</span><span class='op'>$</span><span class='va'>delta</span><span class='op'>)</span>,
                  se    <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>sel1</span><span class='op'>$</span><span class='va'>se.delta</span>, <span class='va'>sel2</span><span class='op'>$</span><span class='va'>se.delta</span>, <span class='va'>sel3</span><span class='op'>$</span><span class='va'>se.delta</span>, <span class='va'>sel4</span><span class='op'>$</span><span class='va'>se.delta</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>tab</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Half-normal"</span>, <span class='st'>"Negative-exponential"</span>, <span class='st'>"Logistic"</span>, <span class='st'>"Power"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>tab</span>, <span class='fl'>2</span><span class='op'>)</span>
</div><div class='output co'>#&gt;                      delta   se
#&gt; Half-normal           3.16 2.99
#&gt; Negative-exponential  2.66 2.35
#&gt; Logistic              3.34 2.39
#&gt; Power                 1.46 1.39</div><div class='input'>
<span class='co'># predicted odds ratios (with 95% CI)</span>
<span class='fu'><a href='predict.rma.html'>predict</a></span><span class='op'>(</span><span class='va'>res</span>,  transf<span class='op'>=</span><span class='va'>exp</span>, digits<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt;  pred ci.lb ci.ub 
#&gt;  0.63  0.48  0.83 
#&gt; </div><div class='input'><span class='fu'><a href='predict.rma.html'>predict</a></span><span class='op'>(</span><span class='va'>sel1</span>, transf<span class='op'>=</span><span class='va'>exp</span>, digits<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt;  pred ci.lb ci.ub 
#&gt;  0.71  0.49  1.04 
#&gt; </div><div class='input'><span class='fu'><a href='predict.rma.html'>predict</a></span><span class='op'>(</span><span class='va'>sel2</span>, transf<span class='op'>=</span><span class='va'>exp</span>, digits<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt;  pred ci.lb ci.ub 
#&gt;  0.76  0.48  1.20 
#&gt; </div><div class='input'><span class='fu'><a href='predict.rma.html'>predict</a></span><span class='op'>(</span><span class='va'>sel3</span>, transf<span class='op'>=</span><span class='va'>exp</span>, digits<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt;  pred ci.lb ci.ub 
#&gt;  0.74  0.49  1.13 
#&gt; </div><div class='input'><span class='fu'><a href='predict.rma.html'>predict</a></span><span class='op'>(</span><span class='va'>sel4</span>, transf<span class='op'>=</span><span class='va'>exp</span>, digits<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt;  pred ci.lb ci.ub 
#&gt;  0.74  0.49  1.12 
#&gt; </div><div class='input'>
<span class='co'># fit selection models including standard error as precision measure</span>
<span class='va'>sel1</span> <span class='op'>&lt;-</span> <span class='fu'>selmodel</span><span class='op'>(</span><span class='va'>res</span>, type<span class='op'>=</span><span class='st'>"halfnorm"</span>, prec<span class='op'>=</span><span class='st'>"sei"</span>, alternative<span class='op'>=</span><span class='st'>"less"</span>, scaleprec<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
<span class='va'>sel2</span> <span class='op'>&lt;-</span> <span class='fu'>selmodel</span><span class='op'>(</span><span class='va'>res</span>, type<span class='op'>=</span><span class='st'>"negexp"</span>,   prec<span class='op'>=</span><span class='st'>"sei"</span>, alternative<span class='op'>=</span><span class='st'>"less"</span>, scaleprec<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
<span class='va'>sel3</span> <span class='op'>&lt;-</span> <span class='fu'>selmodel</span><span class='op'>(</span><span class='va'>res</span>, type<span class='op'>=</span><span class='st'>"logistic"</span>, prec<span class='op'>=</span><span class='st'>"sei"</span>, alternative<span class='op'>=</span><span class='st'>"less"</span>, scaleprec<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
<span class='va'>sel4</span> <span class='op'>&lt;-</span> <span class='fu'>selmodel</span><span class='op'>(</span><span class='va'>res</span>, type<span class='op'>=</span><span class='st'>"power"</span>,    prec<span class='op'>=</span><span class='st'>"sei"</span>, alternative<span class='op'>=</span><span class='st'>"less"</span>, scaleprec<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>

<span class='co'># show estimates of delta (and corresponding SEs)</span>
<span class='va'>tab</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>delta <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>sel1</span><span class='op'>$</span><span class='va'>delta</span>, <span class='va'>sel2</span><span class='op'>$</span><span class='va'>delta</span>, <span class='va'>sel3</span><span class='op'>$</span><span class='va'>delta</span>, <span class='va'>sel4</span><span class='op'>$</span><span class='va'>delta</span><span class='op'>)</span>,
                  se    <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>sel1</span><span class='op'>$</span><span class='va'>se.delta</span>, <span class='va'>sel2</span><span class='op'>$</span><span class='va'>se.delta</span>, <span class='va'>sel3</span><span class='op'>$</span><span class='va'>se.delta</span>, <span class='va'>sel4</span><span class='op'>$</span><span class='va'>se.delta</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>tab</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Half-normal"</span>, <span class='st'>"Negative-exponential"</span>, <span class='st'>"Logistic"</span>, <span class='st'>"Power"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>tab</span>, <span class='fl'>2</span><span class='op'>)</span>
</div><div class='output co'>#&gt;                      delta   se
#&gt; Half-normal           3.51 3.39
#&gt; Negative-exponential  2.28 2.13
#&gt; Logistic              3.02 2.32
#&gt; Power                 1.44 1.38</div><div class='input'>
<span class='co'># predicted odds ratio (with 95% CI)</span>
<span class='fu'><a href='predict.rma.html'>predict</a></span><span class='op'>(</span><span class='va'>res</span>,  transf<span class='op'>=</span><span class='va'>exp</span>, digits<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt;  pred ci.lb ci.ub 
#&gt;  0.63  0.48  0.83 
#&gt; </div><div class='input'><span class='fu'><a href='predict.rma.html'>predict</a></span><span class='op'>(</span><span class='va'>sel1</span>, transf<span class='op'>=</span><span class='va'>exp</span>, digits<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt;  pred ci.lb ci.ub 
#&gt;  0.68  0.49  0.95 
#&gt; </div><div class='input'><span class='fu'><a href='predict.rma.html'>predict</a></span><span class='op'>(</span><span class='va'>sel2</span>, transf<span class='op'>=</span><span class='va'>exp</span>, digits<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt;  pred ci.lb ci.ub 
#&gt;  0.69  0.50  0.95 
#&gt; </div><div class='input'><span class='fu'><a href='predict.rma.html'>predict</a></span><span class='op'>(</span><span class='va'>sel3</span>, transf<span class='op'>=</span><span class='va'>exp</span>, digits<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt;  pred ci.lb ci.ub 
#&gt;  0.68  0.50  0.93 
#&gt; </div><div class='input'><span class='fu'><a href='predict.rma.html'>predict</a></span><span class='op'>(</span><span class='va'>sel4</span>, transf<span class='op'>=</span><span class='va'>exp</span>, digits<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt;  pred ci.lb ci.ub 
#&gt;  0.69  0.50  0.96 
#&gt; </div><div class='input'>
<span class='co'>############################################################################</span>

<span class='co'>### meta-analysis on the effect of environmental tobacco smoke on lung cancer risk</span>

<span class='co'># copy data into 'dat' and examine data</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='va'>dat.hackshaw1998</span>
<span class='va'>dat</span>
</div><div class='output co'>#&gt;    study       author year   country       design cases   or or.lb or.ub 
#&gt; 1      1    Garfinkel 1981       USA       cohort   153 1.18  0.90  1.54 
#&gt; 2      2     Hirayama 1984     Japan       cohort   200 1.45  1.02  2.08 
#&gt; 3      3       Butler 1988       USA       cohort     8 2.02  0.48  8.56 
#&gt; 4      4     Cardenas 1997       USA       cohort   150 1.20  0.80  1.60 
#&gt; 5      5         Chan 1982 Hong Kong case-control    84 0.75  0.43  1.30 
#&gt; 6      6       Correa 1983       USA case-control    22 2.07  0.81  5.25 
#&gt; 7      7 Trichopolous 1983    Greece case-control    62 2.13  1.19  3.83 
#&gt; 8      8      Buffler 1984       USA case-control    41 0.80  0.34  1.90 
#&gt; 9      9        Kabat 1984       USA case-control    24 0.79  0.25  2.45 
#&gt; 10    10          Lam 1985 Hong Kong case-control    60 2.01  1.09  3.72 
#&gt; 11    11    Garfinkel 1985       USA case-control   134 1.23  0.81  1.87 
#&gt; 12    12           Wu 1985       USA case-control    29 1.20  0.50  3.30 
#&gt; 13    13        Akiba 1986     Japan case-control    94 1.52  0.87  2.63 
#&gt; 14    14          Lee 1986        UK case-control    32 1.03  0.41  2.55 
#&gt; 15    15          Koo 1987 Hong Kong case-control    86 1.55  0.90  2.67 
#&gt; 16    16    Pershagen 1987    Sweden case-control    70 1.03  0.61  1.74 
#&gt; 17    17       Humble 1987       USA case-control    20 2.34  0.81  6.75 
#&gt; 18    18          Lam 1987 Hong Kong case-control   199 1.65  1.16  2.35 
#&gt; 19    19          Gao 1987     China case-control   246 1.19  0.82  1.73 
#&gt; 20    20     Brownson 1987       USA case-control    19 1.52  0.39  5.96 
#&gt; 21    21         Geng 1988     China case-control    54 2.16  1.08  4.29 
#&gt; 22    22      Shimizu 1988     Japan case-control    90 1.08  0.64  1.82 
#&gt; 23    23        Inoue 1988     Japan case-control    22 2.55  0.74  8.78 
#&gt; 24    24    Kalandidi 1990    Greece case-control    90 1.62  0.90  2.91 
#&gt; 25    25        Sobue 1990     Japan case-control   144 1.06  0.74  1.52 
#&gt; 26    26  Wu-Williams 1990     China case-control   417 0.79  0.62  1.02 
#&gt; 27    27          Liu 1991     China case-control    54 0.74  0.32  1.69 
#&gt; 28    28       Jockel 1991   Germany case-control    23 2.27  0.75  6.82 
#&gt; 29    29     Brownson 1992       USA case-control   431 0.97  0.78  1.21 
#&gt; 30    30    Stockwell 1992       USA case-control   210 1.60  0.80  3.00 
#&gt; 31    31           Du 1993     China case-control    75 1.19  0.66  2.13 
#&gt; 32    32          Liu 1993     China case-control    38 1.66  0.73  3.78 
#&gt; 33    33      Fontham 1994       USA case-control   651 1.26  1.04  1.54 
#&gt; 34    34        Kabat 1995       USA case-control    67 1.10  0.62  1.96 
#&gt; 35    35      Zaridze 1995    Russia case-control   162 1.66  1.12  2.45 
#&gt; 36    36          Sun 1996     China case-control   230 1.16  0.80  1.69 
#&gt; 37    37         Wang 1996     China case-control   135 1.11  0.67  1.84 
#&gt;         yi     vi 
#&gt; 1   0.1655 0.0188 
#&gt; 2   0.3716 0.0330 
#&gt; 3   0.7031 0.5402 
#&gt; 4   0.1823 0.0313 
#&gt; 5  -0.2877 0.0797 
#&gt; 6   0.7275 0.2273 
#&gt; 7   0.7561 0.0889 
#&gt; 8  -0.2231 0.1927 
#&gt; 9  -0.2357 0.3390 
#&gt; 10  0.6981 0.0981 
#&gt; 11  0.2070 0.0456 
#&gt; 12  0.1823 0.2317 
#&gt; 13  0.4187 0.0796 
#&gt; 14  0.0296 0.2174 
#&gt; 15  0.4383 0.0770 
#&gt; 16  0.0296 0.0715 
#&gt; 17  0.8502 0.2926 
#&gt; 18  0.5008 0.0324 
#&gt; 19  0.1740 0.0363 
#&gt; 20  0.4187 0.4839 
#&gt; 21  0.7701 0.1238 
#&gt; 22  0.0770 0.0711 
#&gt; 23  0.9361 0.3982 
#&gt; 24  0.4824 0.0896 
#&gt; 25  0.0583 0.0337 
#&gt; 26 -0.2357 0.0161 
#&gt; 27 -0.3011 0.1802 
#&gt; 28  0.8198 0.3171 
#&gt; 29 -0.0305 0.0125 
#&gt; 30  0.4700 0.1137 
#&gt; 31  0.1740 0.0893 
#&gt; 32  0.5068 0.1760 
#&gt; 33  0.2311 0.0100 
#&gt; 34  0.0953 0.0862 
#&gt; 35  0.5068 0.0399 
#&gt; 36  0.1484 0.0364 
#&gt; 37  0.1044 0.0664 </div><div class='input'>
<span class='co'># fit random-effects model</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'><a href='rma.uni.html'>rma</a></span><span class='op'>(</span><span class='va'>yi</span>, <span class='va'>vi</span>, data<span class='op'>=</span><span class='va'>dat</span>, method<span class='op'>=</span><span class='st'>"ML"</span><span class='op'>)</span>
<span class='va'>res</span>
</div><div class='output co'>#&gt; 
#&gt; Random-Effects Model (k = 37; tau^2 estimator: ML)
#&gt; 
#&gt; tau^2 (estimated amount of total heterogeneity): 0.0204 (SE = 0.0165)
#&gt; tau (square root of estimated tau^2 value):      0.1427
#&gt; I^2 (total heterogeneity / total variability):   27.62%
#&gt; H^2 (total variability / sampling variability):  1.38
#&gt; 
#&gt; Test for Heterogeneity:
#&gt; Q(df = 36) = 47.4979, p-val = 0.0952
#&gt; 
#&gt; Model Results:
#&gt; 
#&gt; estimate      se    zval    pval   ci.lb   ci.ub 
#&gt;   0.2171  0.0486  4.4712  &lt;.0001  0.1219  0.3123  *** 
#&gt; 
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
#&gt; </div><div class='input'>
<span class='co'># funnel plot</span>
<span class='fu'><a href='funnel.html'>funnel</a></span><span class='op'>(</span><span class='va'>res</span>, atransf<span class='op'>=</span><span class='va'>exp</span>, at<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.25</span>, <span class='fl'>0.5</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>4</span>, <span class='fl'>8</span><span class='op'>)</span><span class='op'>)</span>, ylim<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0.8</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='selmodel-5.png' alt='' width='768' height='614' /></div><div class='input'>
<span class='co'># step function selection model</span>
<span class='co'># \dontrun{</span>
<span class='va'>sel</span> <span class='op'>&lt;-</span> <span class='fu'>selmodel</span><span class='op'>(</span><span class='va'>res</span>, type<span class='op'>=</span><span class='st'>"stepfun"</span>, steps<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.05</span>, <span class='fl'>0.10</span>, <span class='fl'>0.50</span>, <span class='fl'>1.00</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>sel</span>
</div><div class='output co'>#&gt; 
#&gt; Random-Effects Model (k = 37; tau^2 estimator: ML)
#&gt; 
#&gt; tau^2 (estimated amount of total heterogeneity): 0.0307 (SE = 0.0271)
#&gt; tau (square root of estimated tau^2 value):      0.1753
#&gt; 
#&gt; Test for Heterogeneity:
#&gt; LRT(df = 1) = 3.9537, p-val = 0.0468
#&gt; 
#&gt; Model Results:
#&gt; 
#&gt; estimate      se    zval    pval    ci.lb   ci.ub 
#&gt;   0.1217  0.1299  0.9373  0.3486  -0.1328  0.3763    
#&gt; 
#&gt; Test for Selection Model Parameters:
#&gt; LRT(df = 3) = 7.0661, p-val = 0.0698
#&gt; 
#&gt; Selection Model Results:
#&gt; 
#&gt;                    k  estimate      se     zval    pval   ci.lb   ci.ub 
#&gt; 0    &lt; p &lt;= 0.05   7    1.0000     ---      ---     ---     ---     ---    
#&gt; 0.05 &lt; p &lt;= 0.1    8    2.4221  1.6609   0.8562  0.3919  0.0000  5.6773    
#&gt; 0.1  &lt; p &lt;= 0.5   16    0.9775  0.8204  -0.0274  0.9782  0.0000  2.5855    
#&gt; 0.5  &lt; p &lt;= 1      6    0.3967  0.4692  -1.2857  0.1986  0.0000  1.3164    
#&gt; 
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
#&gt; </div><div class='input'>
<span class='co'># plot selection function</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>sel</span><span class='op'>)</span><span class='co'># }</span>
</div><div class='img'><img src='selmodel-6.png' alt='' width='768' height='614' /></div><div class='input'>
<span class='co'>############################################################################</span>

<span class='co'>### validity of student ratings example from Vevea &amp; Woods (2005)</span>

<span class='co'># copy data into 'dat' and examine data</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='va'>dat.cohen1981</span>
<span class='va'>dat</span>
</div><div class='output co'>#&gt;                     study                         sample
#&gt; 1      Bolton et al. 1979             General psychology
#&gt; 2             Bryson 1974                College algebra
#&gt; 3             Centra 1977                General biology
#&gt; 4             Centra 1977             General psychology
#&gt; 5     Crooks &amp; Smock 1974                General physics
#&gt; 6   Doyle &amp; Crichton 1978    Introductory communications
#&gt; 7    Doyle &amp; Whitely 1974               Beginning French
#&gt; 8            Elliott 1950              General chemistry
#&gt; 9    Ellis &amp; Rickard 1977             General psychology
#&gt; 10       Frey et al. 1975          Introductory calculus
#&gt; 11  Greenwood et al. 1976 Analytic geometry and calculus
#&gt; 12           Hoffman 1978              Introductory math
#&gt; 13  McKeachie et al. 1971             General psychology
#&gt; 14      Morsh et al. 1956             Aircraft mechanics
#&gt; 15    Remmers et al. 1949              General chemistry
#&gt; 16 Sullivan &amp; Skanes 1974             First-year science
#&gt; 17 Sullivan &amp; Skanes 1974        Introductory psychology
#&gt; 18 Sullivan &amp; Skanes 1974                First-year math
#&gt; 19 Sullivan &amp; Skanes 1974             First-year biology
#&gt; 20            Wherry 1952        Introductory psychology
#&gt;                                         control  ni    ri
#&gt; 1                             Random assignment  10  0.68
#&gt; 2                                  CIAT pretest  20  0.56
#&gt; 3  Final exam for prior semester of same course  13  0.23
#&gt; 4  Final exam for prior semester of same course  22  0.64
#&gt; 5                                  Math pretest  28  0.49
#&gt; 6                             PSAT verbal score  12 -0.04
#&gt; 7            Minnesota Scholastic Aptitude Test  12  0.49
#&gt; 8                  College entrance exam scores  36  0.33
#&gt; 9                             Random assignment  19  0.58
#&gt; 10                              SAT math scores  12  0.18
#&gt; 11                          Achievement pretest  36 -0.11
#&gt; 12                              SAT math scores  75  0.27
#&gt; 13                     Intelligence test scores  33  0.26
#&gt; 14                           Hydraulics pretest 121  0.40
#&gt; 15                      Orientation test scores  37  0.49
#&gt; 16                            Random assignment  14  0.51
#&gt; 17                            Random assignment  40  0.40
#&gt; 18                            Random assignment  16  0.34
#&gt; 19                            Random assignment  14  0.42
#&gt; 20                               Ability scores  20  0.16</div><div class='input'>
<span class='co'># calculate r-to-z transformed correlations and corresponding sampling variances</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='escalc.html'>escalc</a></span><span class='op'>(</span>measure<span class='op'>=</span><span class='st'>"ZCOR"</span>, ri<span class='op'>=</span><span class='va'>ri</span>, ni<span class='op'>=</span><span class='va'>ni</span>, data<span class='op'>=</span><span class='va'>dat</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>4</span>,<span class='fl'>5</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span>
<span class='va'>dat</span>
</div><div class='output co'>#&gt;                     study  ni    ri      yi     vi 
#&gt; 1      Bolton et al. 1979  10  0.68  0.8291 0.1429 
#&gt; 2             Bryson 1974  20  0.56  0.6328 0.0588 
#&gt; 3             Centra 1977  13  0.23  0.2342 0.1000 
#&gt; 4             Centra 1977  22  0.64  0.7582 0.0526 
#&gt; 5     Crooks &amp; Smock 1974  28  0.49  0.5361 0.0400 
#&gt; 6   Doyle &amp; Crichton 1978  12 -0.04 -0.0400 0.1111 
#&gt; 7    Doyle &amp; Whitely 1974  12  0.49  0.5361 0.1111 
#&gt; 8            Elliott 1950  36  0.33  0.3428 0.0303 
#&gt; 9    Ellis &amp; Rickard 1977  19  0.58  0.6625 0.0625 
#&gt; 10       Frey et al. 1975  12  0.18  0.1820 0.1111 
#&gt; 11  Greenwood et al. 1976  36 -0.11 -0.1104 0.0303 
#&gt; 12           Hoffman 1978  75  0.27  0.2769 0.0139 
#&gt; 13  McKeachie et al. 1971  33  0.26  0.2661 0.0333 
#&gt; 14      Morsh et al. 1956 121  0.40  0.4236 0.0085 
#&gt; 15    Remmers et al. 1949  37  0.49  0.5361 0.0294 
#&gt; 16 Sullivan &amp; Skanes 1974  14  0.51  0.5627 0.0909 
#&gt; 17 Sullivan &amp; Skanes 1974  40  0.40  0.4236 0.0270 
#&gt; 18 Sullivan &amp; Skanes 1974  16  0.34  0.3541 0.0769 
#&gt; 19 Sullivan &amp; Skanes 1974  14  0.42  0.4477 0.0909 
#&gt; 20            Wherry 1952  20  0.16  0.1614 0.0588 </div><div class='input'>
<span class='co'># fit random-effects model</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'><a href='rma.uni.html'>rma</a></span><span class='op'>(</span><span class='va'>yi</span>, <span class='va'>vi</span>, data<span class='op'>=</span><span class='va'>dat</span>, method<span class='op'>=</span><span class='st'>"ML"</span>, digits<span class='op'>=</span><span class='fl'>3</span><span class='op'>)</span>
<span class='va'>res</span>
</div><div class='output co'>#&gt; 
#&gt; Random-Effects Model (k = 20; tau^2 estimator: ML)
#&gt; 
#&gt; tau^2 (estimated amount of total heterogeneity): 0.001 (SE = 0.009)
#&gt; tau (square root of estimated tau^2 value):      0.034
#&gt; I^2 (total heterogeneity / total variability):   2.86%
#&gt; H^2 (total variability / sampling variability):  1.03
#&gt; 
#&gt; Test for Heterogeneity:
#&gt; Q(df = 19) = 20.974, p-val = 0.338
#&gt; 
#&gt; Model Results:
#&gt; 
#&gt; estimate     se   zval   pval  ci.lb  ci.ub 
#&gt;    0.380  0.045  8.505  &lt;.001  0.292  0.468  *** 
#&gt; 
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
#&gt; </div><div class='input'>
<span class='co'># predicted average correlation (with 95% CI)</span>
<span class='fu'><a href='predict.rma.html'>predict</a></span><span class='op'>(</span><span class='va'>res</span>, transf<span class='op'>=</span><span class='va'>transf.ztor</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt;   pred ci.lb ci.ub pi.lb pi.ub 
#&gt;  0.363 0.284 0.436 0.263 0.455 
#&gt; </div><div class='input'>
<span class='co'># funnel plot</span>
<span class='fu'><a href='funnel.html'>funnel</a></span><span class='op'>(</span><span class='va'>res</span>, ylim<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0.4</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='selmodel-7.png' alt='' width='768' height='614' /></div><div class='input'>
<span class='co'># selection functions from Vevea &amp; Woods (2005)</span>
<span class='va'>tab</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>
   steps <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.005</span>, <span class='fl'>0.01</span>, <span class='fl'>0.05</span>, <span class='fl'>0.10</span>, <span class='fl'>0.25</span>, <span class='fl'>0.35</span>, <span class='fl'>0.50</span>, <span class='fl'>0.65</span>, <span class='fl'>0.75</span>, <span class='fl'>0.90</span>, <span class='fl'>0.95</span>, <span class='fl'>0.99</span>, <span class='fl'>0.995</span>, <span class='fl'>1</span><span class='op'>)</span>,
   delta.mod.1 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>0.99</span>, <span class='fl'>0.95</span>, <span class='fl'>0.80</span>, <span class='fl'>0.75</span>, <span class='fl'>0.65</span>, <span class='fl'>0.60</span>, <span class='fl'>0.55</span>, <span class='fl'>0.50</span>, <span class='fl'>0.50</span>, <span class='fl'>0.50</span>, <span class='fl'>0.50</span>, <span class='fl'>0.50</span>, <span class='fl'>0.50</span><span class='op'>)</span>,
   delta.sev.1 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>0.99</span>, <span class='fl'>0.90</span>, <span class='fl'>0.75</span>, <span class='fl'>0.60</span>, <span class='fl'>0.50</span>, <span class='fl'>0.40</span>, <span class='fl'>0.35</span>, <span class='fl'>0.30</span>, <span class='fl'>0.25</span>, <span class='fl'>0.10</span>, <span class='fl'>0.10</span>, <span class='fl'>0.10</span>, <span class='fl'>0.10</span><span class='op'>)</span>,
   delta.mod.2 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>0.99</span>, <span class='fl'>0.95</span>, <span class='fl'>0.90</span>, <span class='fl'>0.80</span>, <span class='fl'>0.75</span>, <span class='fl'>0.60</span>, <span class='fl'>0.60</span>, <span class='fl'>0.75</span>, <span class='fl'>0.80</span>, <span class='fl'>0.90</span>, <span class='fl'>0.95</span>, <span class='fl'>0.99</span>, <span class='fl'>1.00</span><span class='op'>)</span>,
   delta.sev.2 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>0.99</span>, <span class='fl'>0.90</span>, <span class='fl'>0.75</span>, <span class='fl'>0.60</span>, <span class='fl'>0.50</span>, <span class='fl'>0.25</span>, <span class='fl'>0.25</span>, <span class='fl'>0.50</span>, <span class='fl'>0.60</span>, <span class='fl'>0.75</span>, <span class='fl'>0.90</span>, <span class='fl'>0.99</span>, <span class='fl'>1.00</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># apply step function model with a priori chosen selection weights</span>
<span class='co'># \dontrun{</span>
<span class='va'>sel</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>tab</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>delta</span><span class='op'>)</span> <span class='fu'>selmodel</span><span class='op'>(</span><span class='va'>res</span>, type<span class='op'>=</span><span class='st'>"stepfun"</span>, steps<span class='op'>=</span><span class='va'>tab</span><span class='op'>$</span><span class='va'>steps</span>, delta<span class='op'>=</span><span class='va'>delta</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># estimates (transformed correlation) and tau^2 values</span>
<span class='va'>sav</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>estimate <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>res</span><span class='op'>$</span><span class='va'>beta</span>, <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span><span class='op'>(</span><span class='va'>sel</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='va'>x</span><span class='op'>$</span><span class='va'>beta</span><span class='op'>)</span><span class='op'>)</span>, <span class='fl'>2</span><span class='op'>)</span>,
                  varcomp  <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>res</span><span class='op'>$</span><span class='va'>tau2</span>, <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span><span class='op'>(</span><span class='va'>sel</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='va'>x</span><span class='op'>$</span><span class='va'>tau2</span><span class='op'>)</span><span class='op'>)</span>, <span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>sav</span><span class='co'># }</span>
</div><div class='output co'>#&gt;             estimate varcomp
#&gt;                 0.38   0.001
#&gt; delta.mod.1     0.35   0.005
#&gt; delta.sev.1     0.32   0.010
#&gt; delta.mod.2     0.36   0.003
#&gt; delta.sev.2     0.33   0.006</div><div class='input'>
<span class='co'>############################################################################</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Wolfgang Viechtbauer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


