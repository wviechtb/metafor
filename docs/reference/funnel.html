<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Inform modern browsers that this page supports both dark and light color schemes,
  and the page author prefers light. -->
<meta name="color-scheme" content="dark light">
<script>
  // If `prefers-color-scheme` is not supported, fall back to light mode.
  // i.e. In this case, inject the `light` CSS before the others, with
  // no media filter so that it will be downloaded with highest priority.
  if (window.matchMedia("(prefers-color-scheme: dark)").media === "not all") {
    document.documentElement.style.display = "none";
    document.head.insertAdjacentHTML(
      "beforeend",
      "<link id=\"css\" rel=\"stylesheet\" href=\"https://bootswatch.com/3/flatly/bootstrap.css\" onload=\"document.documentElement.style.display = ''\">"
    );
  }
</script>

<title>Funnel Plots — funnel • metafor</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- Flatly Theme - Light  -->
<link id="css-light" rel="stylesheet" href="https://bootswatch.com/3/flatly/bootstrap.css" media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)">

<!-- Darkly Theme - Dark -->
<link id="css-dark" rel="stylesheet" href="https://bootswatch.com/3/darkly/bootstrap.css" media="(prefers-color-scheme: dark)">

<!-- preferably CSS -->
<link rel="stylesheet" href="../preferably.css">
<link id="css-code-light" rel="stylesheet" href="../code-color-scheme-light.css" media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)">
<link id="css-code-dark" rel="stylesheet" href="../code-color-scheme-dark.css" media="(prefers-color-scheme: dark)">

  <script src="../darkswitch.js"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Funnel Plots — funnel" />
<meta property="og:description" content="Function to create funnel plots. " />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:creator" content="@wviechtb" />
<meta name="twitter:site" content="@wviechtb" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>




<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  

  

  </head>

  <body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">metafor</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.5-97</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/metafor-package.html">Intro</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../articles/pkgdown/diagram.html">Diagram</a>
</li>
<li>
  <a href="https://www.jstatsoft.org/index.php/jss/article/view/v036i03/v36i03.pdf">JSS Article (pdf)</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
        <li>
          <a href="#" id="css-toggle-btn">
            <span class="fas fa-adjust fa-lg"></span>
          </a>
        </li>
        
        <li>
  <a href="https://twitter.com/wviechtb">
    <span class="fas fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/wviechtb/metafor">
    <span class="fas fa-github"></span>
     
  </a>
</li>
        
        


      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Funnel Plots</h1>
    
    <div class="hidden name"><code>funnel.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Function to create funnel plots. <script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script></p>
    </div>

    <pre class="usage"><span class='fu'>funnel</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for rma</span>
<span class='fu'>funnel</span><span class='op'>(</span><span class='va'>x</span>, yaxis<span class='op'>=</span><span class='st'>"sei"</span>,
       <span class='va'>xlim</span>, <span class='va'>ylim</span>, <span class='va'>xlab</span>, <span class='va'>ylab</span>,
       steps<span class='op'>=</span><span class='fl'>5</span>, <span class='va'>at</span>, <span class='va'>atransf</span>, <span class='va'>targs</span>, <span class='va'>digits</span>, level<span class='op'>=</span><span class='va'>x</span><span class='op'>$</span><span class='va'>level</span>,
       addtau2<span class='op'>=</span><span class='cn'>FALSE</span>, type<span class='op'>=</span><span class='st'>"rstandard"</span>,
       back<span class='op'>=</span><span class='st'>"lightgray"</span>, shade<span class='op'>=</span><span class='st'>"white"</span>, hlines<span class='op'>=</span><span class='st'>"white"</span>,
       <span class='va'>refline</span>, lty<span class='op'>=</span><span class='fl'>3</span>, pch<span class='op'>=</span><span class='fl'>19</span>, pch.fill<span class='op'>=</span><span class='fl'>21</span>, <span class='va'>col</span>, <span class='va'>bg</span>,
       label<span class='op'>=</span><span class='cn'>FALSE</span>, offset<span class='op'>=</span><span class='fl'>0.4</span>, legend<span class='op'>=</span><span class='cn'>FALSE</span>, ci.res<span class='op'>=</span><span class='fl'>1000</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for default</span>
<span class='fu'>funnel</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>vi</span>, <span class='va'>sei</span>, <span class='va'>ni</span>, <span class='va'>subset</span>, yaxis<span class='op'>=</span><span class='st'>"sei"</span>,
       <span class='va'>xlim</span>, <span class='va'>ylim</span>, <span class='va'>xlab</span>, <span class='va'>ylab</span>,
       steps<span class='op'>=</span><span class='fl'>5</span>, <span class='va'>at</span>, <span class='va'>atransf</span>, <span class='va'>targs</span>, <span class='va'>digits</span>, level<span class='op'>=</span><span class='fl'>95</span>,
       back<span class='op'>=</span><span class='st'>"lightgray"</span>, shade<span class='op'>=</span><span class='st'>"white"</span>, hlines<span class='op'>=</span><span class='st'>"white"</span>,
       refline<span class='op'>=</span><span class='fl'>0</span>, lty<span class='op'>=</span><span class='fl'>3</span>, pch<span class='op'>=</span><span class='fl'>19</span>, <span class='va'>col</span>, <span class='va'>bg</span>,
       label<span class='op'>=</span><span class='cn'>FALSE</span>, offset<span class='op'>=</span><span class='fl'>0.4</span>, legend<span class='op'>=</span><span class='cn'>FALSE</span>, ci.res<span class='op'>=</span><span class='fl'>1000</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>an object of class <code>"rma"</code> or a vector with the observed effect sizes or outcomes.</p></td>
    </tr>
    <tr>
      <th>vi</th>
      <td><p>vector with the corresponding sampling variances (needed if <code>x</code> is a vector with the observed effect sizes or outcomes).</p></td>
    </tr>
    <tr>
      <th>sei</th>
      <td><p>vector with the corresponding standard errors (note: only one of the two, <code>vi</code> or <code>sei</code>, needs to be specified).</p></td>
    </tr>
    <tr>
      <th>ni</th>
      <td><p>vector with the corresponding sample sizes. Only relevant when passing a vector via <code>x</code>.</p></td>
    </tr>
    <tr>
      <th>subset</th>
      <td><p>optional (logical or numeric) vector to specify the subset of studies that should be included in the plot. Only relevant when passing a vector via <code>x</code>.</p></td>
    </tr>
    <tr>
      <th>yaxis</th>
      <td><p>either <code>"sei"</code>, <code>"vi"</code>, <code>"seinv"</code>, <code>"vinv"</code>, <code>"ni"</code>, <code>"ninv"</code>, <code>"sqrtni"</code>, <code>"sqrtninv"</code>, <code>"lni"</code>, or <code>"wi"</code> to indicate what values should be placed on the y-axis. See &#8216;Details&#8217;.</p></td>
    </tr>
    <tr>
      <th>xlim</th>
      <td><p>x-axis limits. If unspecified, the function tries to set the x-axis limits to some sensible values.</p></td>
    </tr>
    <tr>
      <th>ylim</th>
      <td><p>y-axis limits. If unspecified, the function tries to set the y-axis limits to some sensible values.</p></td>
    </tr>
    <tr>
      <th>xlab</th>
      <td><p>title for the x-axis. If unspecified, the function tries to set an appropriate axis title.</p></td>
    </tr>
    <tr>
      <th>ylab</th>
      <td><p>title for the y-axis. If unspecified, the function tries to set an appropriate axis title.</p></td>
    </tr>
    <tr>
      <th>steps</th>
      <td><p>the number of tick marks for the y-axis (the default is 5).</p></td>
    </tr>
    <tr>
      <th>at</th>
      <td><p>position of the x-axis tick marks and corresponding labels. If unspecified, the function tries to set the tick mark positions/labels to some sensible values.</p></td>
    </tr>
    <tr>
      <th>atransf</th>
      <td><p>optional argument to specify a function that should be used to transform the x-axis labels (e.g., <code>atransf=exp</code>; see also <a href='transf.html'>transf</a>). If unspecified, no transformation is used.</p></td>
    </tr>
    <tr>
      <th>targs</th>
      <td><p>optional arguments needed by the function specified via <code>atransf</code>.</p></td>
    </tr>
    <tr>
      <th>digits</th>
      <td><p>integer to specify the number of decimal places to which the tick mark labels of the x- and y-axis should be rounded. Can also be a vector of two integers, the first to specify the number of decimal places for the x-axis, the second for the y-axis labels (e.g., <code>digits=c(2,3)</code>). If unspecified, the function tries to set the argument to some sensible values.</p></td>
    </tr>
    <tr>
      <th>level</th>
      <td><p>numeric value between 0 and 100 to specify the level of the pseudo confidence interval region (for <code>"rma"</code> objects, the default is to take the value from the object). May also be a vector of values to obtain multiple regions. See &#8216;Examples&#8217;.</p></td>
    </tr>
    <tr>
      <th>addtau2</th>
      <td><p>logical to indicate whether the amount of heterogeneity should be accounted for when drawing the pseudo confidence interval region (the default is <code>FALSE</code>). Ignored when the model includes moderators and residuals are plotted. See &#8216;Details&#8217;.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>either <code>"rstandard"</code> (default) or <code>"rstudent"</code> to specify whether the usual or deleted residuals should be used in creating the funnel plot when the model involves moderators. See &#8216;Details&#8217;.</p></td>
    </tr>
    <tr>
      <th>back</th>
      <td><p>color to use for the background of the plotting region (default is <code>"lightgray"</code>).</p></td>
    </tr>
    <tr>
      <th>shade</th>
      <td><p>color to use for shading the pseudo confidence interval region (default is <code>"white"</code>). When <code>level</code> is a vector of values, different shading colors can be specified for each region.</p></td>
    </tr>
    <tr>
      <th>hlines</th>
      <td><p>color of the horizontal reference lines (default is <code>"white"</code>).</p></td>
    </tr>
    <tr>
      <th>refline</th>
      <td><p>numeric value to specify the location of the vertical &#8216;reference&#8217; line and where the pseudo confidence interval should be centered. If unspecified, the reference line is drawn at the fixed- or random-effects model estimate when the model does not include moderators and at zero when moderators are included (and therefore residuals are plotted) or when directly plotting observed outcomes.</p></td>
    </tr>
    <tr>
      <th>lty</th>
      <td><p>line type for the pseudo confidence interval region and the reference line. The default is to draw dotted lines (see <code><a href='https://rdrr.io/r/graphics/par.html'>par</a></code> for other options). Can also be a vector to specify the two line types separately.</p></td>
    </tr>
    <tr>
      <th>pch</th>
      <td><p>plotting symbol to use for the observed outcomes. By default, a filled circle is used. Can also be a vector of values. See <code><a href='https://rdrr.io/r/graphics/points.html'>points</a></code> for other options.</p></td>
    </tr>
    <tr>
      <th>pch.fill</th>
      <td><p>plotting symbol to use for the outcomes filled in by the trim and fill method. By default, a circle is used. Only relevant when plotting an object created by the <code><a href='trimfill.html'>trimfill</a></code> function.</p></td>
    </tr>
    <tr>
      <th>col</th>
      <td><p>optional character string to specify the name of a color to use for the points (<code>"black"</code> is used by default if not specified). Can also be a vector of color names.</p></td>
    </tr>
    <tr>
      <th>bg</th>
      <td><p>optional character string to specify the name of a background color for open plot symbols (<code>"white"</code> is used by default if not specified). Can also be a vector of color names.</p></td>
    </tr>
    <tr>
      <th>label</th>
      <td><p>argument to control the labeling of the points (the default is <code>FALSE</code>). See &#8216;Details&#8217;.</p></td>
    </tr>
    <tr>
      <th>offset</th>
      <td><p>argument to control the distance between the points and the corresponding labels.</p></td>
    </tr>
    <tr>
      <th>legend</th>
      <td><p>logical to indicate whether a legend should be added to the plot (the default is <code>FALSE</code>). Can also be a keyword to indicate the position of the legend (see <code><a href='https://rdrr.io/r/graphics/legend.html'>legend</a></code>).</p></td>
    </tr>
    <tr>
      <th>ci.res</th>
      <td><p>integer to specify the number of y-axis values at which to calculate the bounds of the pseudo confidence interval. The default is <code>1000</code>, which usually provides a sufficient resolution for the plotting.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>other arguments.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>For fixed- and random-effects models (i.e., models not involving moderators), the plot shows the observed effect sizes or outcomes on the x-axis against the corresponding standard errors (i.e., the square root of the sampling variances) on the y-axis. A vertical line indicates the estimate based on the model. A pseudo confidence interval region is drawn around this value with bounds equal to \(\pm 1.96 \mbox{SE}\), where \(\mbox{SE}\) is the standard error value from the y-axis (assuming <code>level=95</code>). If <code>addtau2=TRUE</code> (only for models of class <code>"rma.uni"</code>), then the bounds of the pseudo confidence interval region are equal to \(\pm 1.96 \sqrt{\mbox{SE}^2 + \hat{\tau}^2}\), where \(\hat{\tau}^2\) is the amount of heterogeneity as estimated by the model.</p>
<p>For models involving moderators, the plot shows the residuals on the x-axis against their corresponding standard errors. Either the usual or deleted residuals can be used for that purpose (set via the <code>type</code> argument). See <code><a href='residuals.rma.html'>residuals.rma</a></code> for more details on the different types of residuals.</p>
<p>With the <code>atransf</code> argument, the labels on the x-axis can be transformed with some suitable function. For example, when plotting log odds ratios, one could use <code>transf=exp</code> to obtain a funnel plot with the values on the x-axis corresponding to the odds ratios. See also <a href='transf.html'>transf</a> for some other useful transformation functions in the context of a meta-analysis.</p>
<p>Instead of placing the standard errors on the y-axis, several other options are available by setting the <code>yaxis</code> argument to:</p><ul>
<li><p><code>yaxis="vi"</code> for the sampling variances,</p></li>
<li><p><code>yaxis="seinv"</code> for the inverse of the standard errors,</p></li>
<li><p><code>yaxis="vinv"</code> for the inverse of the sampling variances,</p></li>
<li><p><code>yaxis="ni"</code> for the sample sizes,</p></li>
<li><p><code>yaxis="ninv"</code> for the inverse of the sample sizes,</p></li>
<li><p><code>yaxis="sqrtni"</code> for the square root of the sample sizes,</p></li>
<li><p><code>yaxis="sqrtninv"</code> for the inverse square root of the sample sizes,</p></li>
<li><p><code>yaxis="lni"</code> for the log of the sample sizes,</p></li>
<li><p><code>yaxis="wi"</code> for the weights.</p></li>
</ul><p>However, only when <code>yaxis="sei"</code> (the default) will the pseudo confidence region have the expected (upside-down) funnel shape with straight lines. Also, when placing (a function of) the sample sizes on the y-axis or the weights, then the pseudo confidence region cannot be drawn. See Sterne and Egger (2001) for more details on the choice of the y-axis.</p>
<p>If the object passed to the function comes from the <code><a href='trimfill.html'>trimfill</a></code> function, the outcomes that are filled in by the trim and fill method are also added to the funnel plot. The symbol to use for plotting the filled in values can be specified via the <code>pch.fill</code> argument.</p>
<p>One can also directly pass a vector with the observed effect sizes or outcomes (via <code>x</code>) and the corresponding sampling variances (via <code>vi</code>), standard errors (via <code>sei</code>), and/or sample sizes (via <code>ni</code>) to the function. By default, the vertical reference line is then drawn at zero.</p>
<p>The arguments <code>back</code>, <code>shade</code>, and <code>hlines</code> can be set to <code>NULL</code> to suppress the shading and the horizontal reference line.</p>
<p>With the <code>label</code> argument, one can control whether points in the plot will be labeled. If <code>label="all"</code> (or <code>label=TRUE</code>), all points in the plot will be labeled. If <code>label="out"</code>, points falling outside of the pseudo confidence region will be labeled. Finally, one can also set this argument to a numeric value (between 1 and \(k\)) to specify how many of the most extreme points should be labeled (e.g., with <code>label=1</code> only the most extreme point would be labeled, while with <code>label=3</code>, the most extreme, and the second and third most extreme points would be labeled). With the <code>offset</code> argument, one can adjust the distance between the labels and the corresponding points.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Placing (a function of) the sample sizes on the y-axis (i.e., using <code>yaxis="ni"</code>, <code>yaxis="ninv"</code>, <code>yaxis="sqrtni"</code>, <code>yaxis="sqrtninv"</code>, or <code>yaxis="lni"</code>) is only possible when information about the sample sizes is actually stored within the object passed to the <code>funnel</code> function. That should automatically be the case when the observed effect sizes or outcomes were computed with the <code><a href='escalc.html'>escalc</a></code> function or when the observed effect sizes or outcomes were computed within the model fitting function. On the other hand, this will not be the case when <code><a href='rma.uni.html'>rma.uni</a></code> was used together with the <code>yi</code> and <code>vi</code> arguments and the <code>yi</code> and <code>vi</code> values were <em>not</em> computed with <code><a href='escalc.html'>escalc</a></code>. In that case, it is still possible to pass information about the sample sizes to the <code><a href='rma.uni.html'>rma.uni</a></code> function (e.g., use <code>rma.uni(yi, vi, ni=ni, data=dat)</code>, where data frame <code>dat</code> includes a variable called <code>ni</code> with the sample sizes).</p>
<p>When using unweighted estimation, using <code>yaxis="wi"</code> will place all points on a horizontal line. When directly passing a vector with the observed effect sizes or outcomes to the function, <code>yaxis="wi"</code> is equivalent to <code>yaxis="vinv"</code>, except that the weights are expressed in percent.</p>
<p>When specifying vectors for <code>pch</code>, <code>col</code>, and/or <code>bg</code>, the variables specified are assumed to be of the same length as the data passed to the funnel function or the model fitting function (when using <code>funnel</code> on a model object). Any subsetting and removal of studies with missing values is automatically applied to the variables specified via these arguments.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A data frame with components:</p>
<dt>x</dt><dd><p>the x-axis coordinates of the points that were plotted.</p></dd>
   <dt>y</dt><dd><p>the y-axis coordinates of the points that were plotted.</p></dd>
   <dt>slab</dt><dd><p>the study labels.</p></dd>
   Note that the data frame is returned invisibly.

    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Wolfgang Viechtbauer <a href='mailto:wvb@metafor-project.org'>wvb@metafor-project.org</a> <a href='https://www.metafor-project.org'>https://www.metafor-project.org</a></p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Light, R. J., &amp; Pillemer, D. B. (1984). <em>Summing up: The science of reviewing research</em>. Cambridge, MA: Harvard University Press.</p>
<p>Peters, J. L., Sutton, A. J., Jones, D. R., Abrams, K. R., &amp; Rushton, L. (2008). Contour-enhanced meta-analysis funnel plots help distinguish publication bias from other causes of asymmetry. <em>Journal of Clinical Epidemiology</em>, <b>61</b>(10), 991--996. <a href='https://doi.org/10.1016/j.jclinepi.2007.11.010'>https://doi.org/10.1016/j.jclinepi.2007.11.010</a></p>
<p>Sterne, J. A. C., &amp; Egger, M. (2001). Funnel plots for detecting bias in meta-analysis: Guidelines on choice of axis. <em>Journal of Clinical Epidemiology</em>, <b>54</b>(10), 1046--1055. <a href='https://doi.org/10.1016/s0895-4356(01)00377-8'>https://doi.org/10.1016/s0895-4356(01)00377-8</a></p>
<p>Viechtbauer, W. (2010). Conducting meta-analyses in R with the metafor package. <em>Journal of Statistical Software</em>, <b>36</b>(3), 1--48. <a href='https://doi.org/10.18637/jss.v036.i03'>https://doi.org/10.18637/jss.v036.i03</a></p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='rma.uni.html'>rma.uni</a></code>, <code><a href='rma.mh.html'>rma.mh</a></code>, <code><a href='rma.peto.html'>rma.peto</a></code>, <code><a href='rma.glmm.html'>rma.glmm</a></code>, <code><a href='rma.mv.html'>rma.mv</a></code>, <code><a href='trimfill.html'>trimfill</a></code>, <code><a href='regtest.html'>regtest</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>### copy BCG vaccine data into 'dat'</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='va'>dat.bcg</span>

<span class='co'>### calculate log risk ratios and corresponding sampling variances</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='escalc.html'>escalc</a></span><span class='op'>(</span>measure<span class='op'>=</span><span class='st'>"RR"</span>, ai<span class='op'>=</span><span class='va'>tpos</span>, bi<span class='op'>=</span><span class='va'>tneg</span>, ci<span class='op'>=</span><span class='va'>cpos</span>, di<span class='op'>=</span><span class='va'>cneg</span>, data<span class='op'>=</span><span class='va'>dat</span><span class='op'>)</span>

<span class='co'>### fit random-effects model</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'><a href='rma.uni.html'>rma</a></span><span class='op'>(</span><span class='va'>yi</span>, <span class='va'>vi</span>, data<span class='op'>=</span><span class='va'>dat</span>, slab<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>$</span><span class='va'>author</span>, <span class='va'>dat</span><span class='op'>$</span><span class='va'>year</span>, sep<span class='op'>=</span><span class='st'>", "</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>### draw a standard funnel plot</span>
<span class='fu'>funnel</span><span class='op'>(</span><span class='va'>res</span><span class='op'>)</span>
</div><div class='img'><img src='funnel-1.png' alt='' width='864' height='768' /></div><div class='input'>
<span class='co'>### show risk ratio values on x-axis (log scale)</span>
<span class='fu'>funnel</span><span class='op'>(</span><span class='va'>res</span>, atransf<span class='op'>=</span><span class='va'>exp</span><span class='op'>)</span>
</div><div class='input'>
<span class='co'>### label points outside of the pseudo confidence interval region</span>
<span class='fu'>funnel</span><span class='op'>(</span><span class='va'>res</span>, atransf<span class='op'>=</span><span class='va'>exp</span>, label<span class='op'>=</span><span class='st'>"out"</span><span class='op'>)</span>
</div><div class='img'><img src='funnel-2.png' alt='' width='864' height='768' /></div><div class='input'>
<span class='co'>### passing log risk ratios and sampling variances directly to the function</span>
<span class='co'>### note: same plot, except that reference line is centered at zero</span>
<span class='fu'>funnel</span><span class='op'>(</span><span class='va'>dat</span><span class='op'>$</span><span class='va'>yi</span>, <span class='va'>dat</span><span class='op'>$</span><span class='va'>vi</span><span class='op'>)</span>
</div><div class='input'>
<span class='co'>### can accomplish the same thing by setting refline=0</span>
<span class='fu'>funnel</span><span class='op'>(</span><span class='va'>res</span>, refline<span class='op'>=</span><span class='fl'>0</span><span class='op'>)</span>
</div><div class='img'><img src='funnel-3.png' alt='' width='864' height='768' /></div><div class='input'>
<span class='co'>### adjust the position of the x-axis labels, number of digits, and y-axis limits</span>
<span class='fu'>funnel</span><span class='op'>(</span><span class='va'>res</span>, atransf<span class='op'>=</span><span class='va'>exp</span>, at<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>.125</span>, <span class='fl'>.25</span>, <span class='fl'>.5</span>, <span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>, digits<span class='op'>=</span><span class='fl'>3L</span>, ylim<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>.8</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='funnel-4.png' alt='' width='864' height='768' /></div><div class='input'>
<span class='co'>### contour-enhanced funnel plot centered at 0 (see Peters et al., 2008)</span>
<span class='fu'>funnel</span><span class='op'>(</span><span class='va'>res</span>, level<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>90</span>, <span class='fl'>95</span>, <span class='fl'>99</span><span class='op'>)</span>, shade<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"white"</span>, <span class='st'>"gray55"</span>, <span class='st'>"gray75"</span><span class='op'>)</span>, refline<span class='op'>=</span><span class='fl'>0</span>, legend<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='img'><img src='funnel-5.png' alt='' width='864' height='768' /></div><div class='input'>
<span class='co'>### same, but show risk ratio values on the x-axis and some further adjustments</span>
<span class='fu'>funnel</span><span class='op'>(</span><span class='va'>res</span>, level<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>90</span>, <span class='fl'>95</span>, <span class='fl'>99</span><span class='op'>)</span>, shade<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"white"</span>, <span class='st'>"gray55"</span>, <span class='st'>"gray75"</span><span class='op'>)</span>, digits<span class='op'>=</span><span class='fl'>3L</span>, ylim<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>.8</span><span class='op'>)</span>,
       refline<span class='op'>=</span><span class='fl'>0</span>, legend<span class='op'>=</span><span class='cn'>TRUE</span>, atransf<span class='op'>=</span><span class='va'>exp</span>, at<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>.125</span>, <span class='fl'>.25</span>, <span class='fl'>.5</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>4</span>, <span class='fl'>8</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='funnel-6.png' alt='' width='864' height='768' /></div><div class='input'>
<span class='co'>### illustrate the use of vectors for 'pch' and 'col'</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'><a href='rma.uni.html'>rma</a></span><span class='op'>(</span><span class='va'>yi</span>, <span class='va'>vi</span>, data<span class='op'>=</span><span class='va'>dat</span>, subset<span class='op'>=</span><span class='fl'>2</span><span class='op'>:</span><span class='fl'>10</span><span class='op'>)</span>
<span class='fu'>funnel</span><span class='op'>(</span><span class='va'>res</span>, pch<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>$</span><span class='va'>yi</span> <span class='op'>&gt;</span> <span class='op'>-</span><span class='fl'>1</span>, <span class='fl'>19</span>, <span class='fl'>21</span><span class='op'>)</span>, col<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>$</span><span class='va'>vi</span><span class='op'>)</span> <span class='op'>&gt;</span> <span class='fl'>.3</span>, <span class='st'>"red"</span>, <span class='st'>"blue"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='funnel-7.png' alt='' width='864' height='768' /></div><div class='input'>
<span class='co'>### can add a second funnel via (undocumented) argument refline2</span>
<span class='fu'>funnel</span><span class='op'>(</span><span class='va'>res</span>, atransf<span class='op'>=</span><span class='va'>exp</span>, at<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>.125</span>, <span class='fl'>.25</span>, <span class='fl'>.5</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span>, digits<span class='op'>=</span><span class='fl'>3L</span>, ylim<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>.8</span><span class='op'>)</span>, refline2<span class='op'>=</span><span class='fl'>0</span><span class='op'>)</span>
</div><div class='img'><img src='funnel-8.png' alt='' width='864' height='768' /></div><div class='input'>
<span class='co'>### mixed-effects model with absolute latitude in the model</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'><a href='rma.uni.html'>rma</a></span><span class='op'>(</span><span class='va'>yi</span>, <span class='va'>vi</span>, mods <span class='op'>=</span> <span class='op'>~</span> <span class='va'>ablat</span>, data<span class='op'>=</span><span class='va'>dat</span><span class='op'>)</span>

<span class='co'>### funnel plot of the residuals</span>
<span class='fu'>funnel</span><span class='op'>(</span><span class='va'>res</span><span class='op'>)</span>
</div><div class='img'><img src='funnel-9.png' alt='' width='864' height='768' /></div><div class='input'>
<span class='co'>### simulate a large meta-analytic dataset (correlations with rho = 0.2)</span>
<span class='co'>### with no heterogeneity or publication bias; then try out different</span>
<span class='co'>### versions of the funnel plot</span>

<span class='va'>gencor</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>rhoi</span>, <span class='va'>ni</span><span class='op'>)</span> <span class='op'>{</span>
   <span class='va'>x1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>ni</span>, mean<span class='op'>=</span><span class='fl'>0</span>, sd<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
   <span class='va'>x2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>ni</span>, mean<span class='op'>=</span><span class='fl'>0</span>, sd<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
   <span class='va'>x3</span> <span class='op'>&lt;-</span> <span class='va'>rhoi</span><span class='op'>*</span><span class='va'>x1</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>-</span><span class='va'>rhoi</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>*</span><span class='va'>x2</span>
   <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='va'>x1</span>, <span class='va'>x3</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1234</span><span class='op'>)</span>
<span class='va'>k</span>  <span class='op'>&lt;-</span> <span class='fl'>200</span>                               <span class='co'>### number of studies to simulate</span>
<span class='va'>ni</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Chisquare.html'>rchisq</a></span><span class='op'>(</span><span class='va'>k</span>, df<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>20</span> <span class='op'>+</span> <span class='fl'>20</span><span class='op'>)</span>  <span class='co'>### simulate sample sizes (skewed distribution)</span>
<span class='va'>ri</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/mapply.html'>mapply</a></span><span class='op'>(</span><span class='va'>gencor</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0.2</span>,<span class='va'>k</span><span class='op'>)</span>, <span class='va'>ni</span><span class='op'>)</span>    <span class='co'>### simulate correlations</span>

<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'><a href='rma.uni.html'>rma</a></span><span class='op'>(</span>measure<span class='op'>=</span><span class='st'>"ZCOR"</span>, ri<span class='op'>=</span><span class='va'>ri</span>, ni<span class='op'>=</span><span class='va'>ni</span>, method<span class='op'>=</span><span class='st'>"FE"</span><span class='op'>)</span> <span class='co'>### use r-to-z transformed correlations</span>

<span class='fu'>funnel</span><span class='op'>(</span><span class='va'>res</span>, yaxis<span class='op'>=</span><span class='st'>"sei"</span><span class='op'>)</span>
</div><div class='img'><img src='funnel-10.png' alt='' width='864' height='768' /></div><div class='input'><span class='fu'>funnel</span><span class='op'>(</span><span class='va'>res</span>, yaxis<span class='op'>=</span><span class='st'>"vi"</span><span class='op'>)</span>
</div><div class='img'><img src='funnel-11.png' alt='' width='864' height='768' /></div><div class='input'><span class='fu'>funnel</span><span class='op'>(</span><span class='va'>res</span>, yaxis<span class='op'>=</span><span class='st'>"seinv"</span><span class='op'>)</span>
</div><div class='img'><img src='funnel-12.png' alt='' width='864' height='768' /></div><div class='input'><span class='fu'>funnel</span><span class='op'>(</span><span class='va'>res</span>, yaxis<span class='op'>=</span><span class='st'>"vinv"</span><span class='op'>)</span>
</div><div class='img'><img src='funnel-13.png' alt='' width='864' height='768' /></div><div class='input'><span class='fu'>funnel</span><span class='op'>(</span><span class='va'>res</span>, yaxis<span class='op'>=</span><span class='st'>"ni"</span><span class='op'>)</span>
</div><div class='img'><img src='funnel-14.png' alt='' width='864' height='768' /></div><div class='input'><span class='fu'>funnel</span><span class='op'>(</span><span class='va'>res</span>, yaxis<span class='op'>=</span><span class='st'>"ninv"</span><span class='op'>)</span>
</div><div class='img'><img src='funnel-15.png' alt='' width='864' height='768' /></div><div class='input'><span class='fu'>funnel</span><span class='op'>(</span><span class='va'>res</span>, yaxis<span class='op'>=</span><span class='st'>"sqrtni"</span><span class='op'>)</span>
</div><div class='img'><img src='funnel-16.png' alt='' width='864' height='768' /></div><div class='input'><span class='fu'>funnel</span><span class='op'>(</span><span class='va'>res</span>, yaxis<span class='op'>=</span><span class='st'>"sqrtninv"</span><span class='op'>)</span>
</div><div class='img'><img src='funnel-17.png' alt='' width='864' height='768' /></div><div class='input'><span class='fu'>funnel</span><span class='op'>(</span><span class='va'>res</span>, yaxis<span class='op'>=</span><span class='st'>"lni"</span><span class='op'>)</span>
</div><div class='img'><img src='funnel-18.png' alt='' width='864' height='768' /></div><div class='input'><span class='fu'>funnel</span><span class='op'>(</span><span class='va'>res</span>, yaxis<span class='op'>=</span><span class='st'>"wi"</span><span class='op'>)</span>
</div><div class='img'><img src='funnel-19.png' alt='' width='864' height='768' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Wolfgang Viechtbauer.</p>
</div>

<div class="pkgdown">
  <p>Made with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.9001, using <a href="https://preferably.amirmasoudabdol.name/?source=footer">preferably</a> template.</p>
</div>

      </footer>
   </div>

  


  

  </body>
</html>


